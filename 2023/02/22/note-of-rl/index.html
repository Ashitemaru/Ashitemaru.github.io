<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic%7CNoto+Serif+KR:300,300italic,400,400italic,700,700italic%7CMS+PMincho:300,300italic,400,400italic,700,700italic%7CFira+Code:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext" referrerpolicy="no-referrer">

<link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://unpkg.com/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;ashitemaru.github.io&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Muse&quot;,&quot;version&quot;:&quot;8.5.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;width&quot;:320,&quot;display&quot;:&quot;always&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:true,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:false,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:&quot;disqusjs&quot;,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;æœç´¢...&quot;,&quot;empty&quot;:&quot;æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}&quot;,&quot;hits_time&quot;:&quot;æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰&quot;,&quot;hits&quot;:&quot;æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ&quot;},&quot;path&quot;:&quot;&#x2F;search.json&quot;,&quot;localsearch&quot;:{&quot;enable&quot;:true,&quot;trigger&quot;:&quot;manual&quot;,&quot;top_n_per_article&quot;:1,&quot;unescape&quot;:false,&quot;preload&quot;:false}}</script><script src="/js/config.js"></script>
<meta name="description" content="è¿™å­¦æœŸé€‰äº†ä¸€é—¨æ·±åº¦å¼ºåŒ–å­¦ä¹ ï¼Œä¹Ÿæ­£å¥½è¶æ­¤æœºä¼šç³»ç»Ÿæ€§è´¨åœ°æŠŠå¼ºåŒ–å­¦ä¹ ç†è®ºåŸºç¡€è¿‡ä¸€ä¸‹ï¼Œå¦‚æœå¯ä»¥çš„è¯å¯èƒ½è¿˜æ‰“ç®—è¿‡ä¸€ä¸‹æ·±åº¦å­¦ä¹ åŸºç¡€æ‰©å±•ä¸€ä¸‹è§†é‡ä¹‹ç±»çš„ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="å¼ºåŒ–å­¦ä¹ å…¥é—¨ç¬”è®°">
<meta property="og:url" content="https://ashitemaru.github.io/2023/02/22/note-of-rl/index.html">
<meta property="og:site_name" content="Ashitemaru">
<meta property="og:description" content="è¿™å­¦æœŸé€‰äº†ä¸€é—¨æ·±åº¦å¼ºåŒ–å­¦ä¹ ï¼Œä¹Ÿæ­£å¥½è¶æ­¤æœºä¼šç³»ç»Ÿæ€§è´¨åœ°æŠŠå¼ºåŒ–å­¦ä¹ ç†è®ºåŸºç¡€è¿‡ä¸€ä¸‹ï¼Œå¦‚æœå¯ä»¥çš„è¯å¯èƒ½è¿˜æ‰“ç®—è¿‡ä¸€ä¸‹æ·±åº¦å­¦ä¹ åŸºç¡€æ‰©å±•ä¸€ä¸‹è§†é‡ä¹‹ç±»çš„ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ashitemaru.github.io/uploads/note-of-rl/1.webp">
<meta property="article:published_time" content="2023-02-22T17:39:55.000Z">
<meta property="article:modified_time" content="2023-02-22T17:39:55.000Z">
<meta property="article:author" content="Ashitemaru">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ashitemaru.github.io/uploads/note-of-rl/1.webp">


<link rel="canonical" href="https://ashitemaru.github.io/2023/02/22/note-of-rl/">



<script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:false,&quot;isPost&quot;:true,&quot;lang&quot;:&quot;zh-CN&quot;,&quot;comments&quot;:true,&quot;permalink&quot;:&quot;https:&#x2F;&#x2F;ashitemaru.github.io&#x2F;2023&#x2F;02&#x2F;22&#x2F;note-of-rl&#x2F;&quot;,&quot;path&quot;:&quot;2023&#x2F;02&#x2F;22&#x2F;note-of-rl&#x2F;&quot;,&quot;title&quot;:&quot;å¼ºåŒ–å­¦ä¹ å…¥é—¨ç¬”è®°&quot;}</script>

<script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script>
<title>å¼ºåŒ–å­¦ä¹ å…¥é—¨ç¬”è®° | Ashitemaru</title>
  



<link rel="stylesheet" href="https://www.unpkg.com/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://www.unpkg.com/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://www.unpkg.com/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
<script src="https://www.unpkg.com/twikoo@1.4.1/dist/twikoo.all.min.js"></script>
<script src="/js/jquery.min.js"></script>
<script>
function getURL(e) {
    var http = e.slice(0, 4)
    var https = e.slice(0, 5)
    if (http == "http" || https == "https") {
        return e
    } else if (e == "" || e == null || e == undefined) {
        return e
    } else {
        e = 'http://' + e
        return e
    }
}

function newComment() {
    twikoo.getRecentComments({
        envId: 'https://vercel-deploy-two.vercel.app',
        pageSize: 10,
        includeReply: false
    }).then(function (res) {
        var hotComments = $("#hot-comments");
        for (var i = 0; i < res.length; i++) {
            var nick = res[i].nick;
            var content = res[i].commentText;
            var newcontent = content.substring(0, 50);
            var url = res[i].url;
            var avatar = res[i].avatar;
            var link = getURL(res[i].link);
            var updatedAt = res[i].relativeTime;
            var commentId = '#' + res[i].id;
            hotComments.append(
                `<li class="px1 pb2 flex items-center">
                    <img style="width:40px;height:40px" class="circle mx1 listavatar" src="${avatar}">
                    <div style="display:flex;flex-direction:column;width:100%;">
                        <div style="display:flex;justify-content:space-between;flex-direction:row;align-items:center;">
                            <div class="h5 listauthor overflow-hidden" title="${nick}">
                                <a target="_blank" rel="noopener external nofollow noreferrer" href="${link}">${nick}</a>
                            </div>
                            <div class="h6 mr1 listdate wenzi hang1" style="color:#777777;">${updatedAt}</div>
                        </div>
                        <div style="display:flex;flex-direction:row;width:100%;">
                            <a class="h5 list-comcontent" style="overflow:hidden;display:flex;border-bottom:0px;text-overflow:ellipsis;line-height:1.5;text-align:left" href="${url}${commentId}">${newcontent}</a>
                        </div>
                    </div>
                </li>`
            );
        }
    }).catch(function (err) {
        console.error(err);
    });
}

function replaceRuby() {
    $('code')
        .filter((_, node) => {
            var list = $(node).text().split(' ');
            return list.length === 3 && list[0] === "@";
        })
        .replaceWith((_, text) => {
            var list = text.split(' ');
            var written = list[1];
            var read = list[2];
            return $(`<ruby>${written}<rp>(</rp><rt>${read}</rt><rp>)</rp></ruby>`);
        });
}

$(function () {
    newComment();
    replaceRuby();
});
</script>

<!-- CSS -->
<link href="/css/app.min.css" rel="stylesheet">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Ashitemaru</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">14</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">55</span></a></li>
        <li class="menu-item menu-item-skill-docs"><a href="https://sast-skill-docers.github.io/sast-skill-docs/" rel="noopener" target="_blank"><i class="fa fa-book fa-fw"></i>æŠ€èƒ½å¼•å¯¼æ–‡æ¡£</a></li>
        <li class="menu-item menu-item-thuinfo"><a href="https://www.thuinfo.net/" rel="noopener" target="_blank"><i class="fa fa-sitemap fa-fw"></i>THUInfo</a></li>
        <li class="menu-item menu-item-se-index"><a href="https://thuse-course.github.io/course-index/" rel="noopener" target="_blank"><i class="fa fa-calendar fa-fw"></i>è½¯å·¥è¯¾ç¨‹ä¸»é¡µ</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BC%98%E5%8C%96%E7%90%86%E8%AE%BA"><span class="nav-number">1.</span> <span class="nav-text">å¼ºåŒ–å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µä¸åŸºæœ¬ä¼˜åŒ–ç†è®º</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E4%B8%8E%E7%AD%96%E7%95%A5"><span class="nav-number">1.1.</span> <span class="nav-text">ç¯å¢ƒä¸ç­–ç•¥</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B4%AF%E8%AE%A1%E6%94%B6%E7%9B%8A%E4%B8%8E%E4%BB%B7%E5%80%BC%E5%87%BD%E6%95%B0"><span class="nav-number">1.2.</span> <span class="nav-text">ç´¯è®¡æ”¶ç›Šä¸ä»·å€¼å‡½æ•°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E4%BC%98%E5%8C%96%E7%90%86%E8%AE%BA"><span class="nav-number">1.3.</span> <span class="nav-text">åŸºæœ¬ä¼˜åŒ–ç†è®º</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E5%AE%8C%E5%85%A8%E7%8E%AF%E5%A2%83%E7%9F%A5%E8%AF%86%E7%9A%84-rl-%E6%96%B9%E6%B3%95"><span class="nav-number">2.</span> <span class="nav-text">åŸºäºå®Œå…¨ç¯å¢ƒçŸ¥è¯†çš„ RL æ–¹æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#policy-iteration-pi"><span class="nav-number">2.1.</span> <span class="nav-text">Policy Iteration (PI)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#value-iteration-vi"><span class="nav-number">2.2.</span> <span class="nav-text">Value Iteration (VI)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%89%E5%85%B3-pi-%E5%92%8C-vi-%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AF%B9%E6%AF%94"><span class="nav-number">2.3.</span> <span class="nav-text">æœ‰å…³ PI å’Œ VI çš„ä¸€äº›å¯¹æ¯”</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%89%E5%85%B3-bellman-%E7%AE%97%E5%AD%90%E7%9A%84%E6%8B%93%E5%B1%95"><span class="nav-number">2.4.</span> <span class="nav-text">æœ‰å…³ Bellman ç®—å­çš„æ‹“å±•</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E7%8E%AF%E5%A2%83%E4%BA%A4%E4%BA%92%E7%9A%84-rl-%E6%96%B9%E6%B3%95"><span class="nav-number">3.</span> <span class="nav-text">åŸºäºç¯å¢ƒäº¤äº’çš„ RL æ–¹æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%96%E7%95%A5%E8%AF%84%E4%BC%B0"><span class="nav-number">3.1.</span> <span class="nav-text">ç­–ç•¥è¯„ä¼°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#monte-carlo-mc"><span class="nav-number">3.1.1.</span> <span class="nav-text">Monte-Carlo (MC)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#temporal-difference-td"><span class="nav-number">3.1.2.</span> <span class="nav-text">Temporal-Difference (TD)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E6%AD%A5-td-target-%E4%B8%8E-tdlambda"><span class="nav-number">3.1.2.1.</span> <span class="nav-text">å¤šæ­¥ TD target ä¸ TD(Î»)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#backward-view-tdlambda-eligibility-traces"><span class="nav-number">3.1.2.2.</span> <span class="nav-text">Backward-view
TD(Î») &amp; Eligibility
Traces</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%96%E7%95%A5%E6%94%B9%E8%BF%9B"><span class="nav-number">3.2.</span> <span class="nav-text">ç­–ç•¥æ”¹è¿›</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%97%B6%E5%BA%8F%E5%B7%AE%E5%88%86%E6%8E%A7%E5%88%B6"><span class="nav-number">4.</span> <span class="nav-text">æ—¶åºå·®åˆ†æ§åˆ¶</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%8C%E8%BD%A8%E6%97%B6%E5%BA%8F%E5%B7%AE%E5%88%86%E6%8E%A7%E5%88%B6sarsa"><span class="nav-number">4.1.</span> <span class="nav-text">åŒè½¨æ—¶åºå·®åˆ†æ§åˆ¶ï¼ˆSARSAï¼‰</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%82%E8%BD%A8%E6%97%B6%E5%BA%8F%E5%B7%AE%E5%88%86%E6%8E%A7%E5%88%B6q-learning"><span class="nav-number">4.2.</span> <span class="nav-text">å¼‚è½¨æ—¶åºå·®åˆ†æ§åˆ¶ï¼ˆQ learningï¼‰</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E6%8E%A7%E5%88%B6"><span class="nav-number">5.</span> <span class="nav-text">è’™ç‰¹å¡æ´›æ§åˆ¶</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%8C%E8%BD%A8%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E6%8E%A7%E5%88%B6"><span class="nav-number">5.1.</span> <span class="nav-text">åŒè½¨è’™ç‰¹å¡æ´›æ§åˆ¶</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%82%E8%BD%A8%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E6%8E%A7%E5%88%B6"><span class="nav-number">5.2.</span> <span class="nav-text">å¼‚è½¨è’™ç‰¹å¡æ´›æ§åˆ¶</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E4%BC%B0%E8%AE%A1%E4%B8%8E%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0"><span class="nav-number">6.</span> <span class="nav-text">å‡½æ•°ä¼°è®¡ä¸æ·±åº¦å­¦ä¹ </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#deep-q-network-dqn"><span class="nav-number">6.1.</span> <span class="nav-text">Deep Q Network (DQN)</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Ashitemaru"
      src="/uploads/avatar.png">
  <p class="site-author-name" itemprop="name">Ashitemaru</p>
  <div class="site-description" itemprop="description">Trying to be an observer of this world.</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">55</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Ashitemaru" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;Ashitemaru" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:ashitemaru.holder@gmail.com" title="E-Mail â†’ mailto:ashitemaru.holder@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/Holder_ASTMR" title="Twitter â†’ https:&#x2F;&#x2F;twitter.com&#x2F;Holder_ASTMR" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      Friends
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.unidy.cn/" title="https:&#x2F;&#x2F;www.unidy.cn" rel="noopener" target="_blank">UNIDY</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.dilant.cn/" title="https:&#x2F;&#x2F;www.dilant.cn" rel="noopener" target="_blank">Dilant</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://zcy.moe/" title="https:&#x2F;&#x2F;zcy.moe" rel="noopener" target="_blank">çŒ«çŒ«</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://c7w.tech/" title="https:&#x2F;&#x2F;c7w.tech" rel="noopener" target="_blank">c7w</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.leenldk.top/" title="http:&#x2F;&#x2F;www.leenldk.top&#x2F;" rel="noopener" target="_blank">leenldk (20)</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://sun80449.github.io/" title="https:&#x2F;&#x2F;sun80449.github.io" rel="noopener" target="_blank">lcr</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://pwe.cat/" title="https:&#x2F;&#x2F;pwe.cat" rel="noopener" target="_blank">ç´¢å°”</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://kokic.github.io/" title="https:&#x2F;&#x2F;kokic.github.io&#x2F;" rel="noopener" target="_blank">kokic</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://sjfh.top/" title="https:&#x2F;&#x2F;sjfh.top" rel="noopener" target="_blank">sjfh</a>
        </li>
    </ul>
  </div>
<div class="sidebar-1 mybox relative">
    <div class="p2">
        <i class="fab fa-facebook-messenger mr1"></i>
        Latest Comments
    </div>
    <div id="hot-comments"></div>
</div>
          </div>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/Ashitemaru" class="github-corner" title="Come here for fun." aria-label="Come here for fun." rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ashitemaru.github.io/2023/02/22/note-of-rl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.png">
      <meta itemprop="name" content="Ashitemaru">
      <meta itemprop="description" content="Trying to be an observer of this world.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ashitemaru">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          å¼ºåŒ–å­¦ä¹ å…¥é—¨ç¬”è®°
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2023-02-22 17:39:55" itemprop="dateCreated datePublished" datetime="2023-02-22T17:39:55+00:00">2023-02-22</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-02-22 17:39:55" itemprop="dateModified" datetime="2023-02-22T17:39:55+00:00">2023-02-22</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E8%AE%A1%E7%AE%97%E6%9C%BA/" itemprop="url" rel="index"><span itemprop="name">ã€å­¦ä¹ ç¬”è®°ã€‘è®¡ç®—æœº</span></a>
        </span>
    </span>

  
    <span id="/2023/02/22/note-of-rl/" class="post-meta-item twikoo_visitors" data-flag-title="å¼ºåŒ–å­¦ä¹ å…¥é—¨ç¬”è®°" title="é˜…è¯»æ¬¡æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span id="twikoo_visitors"></span>
    </span>
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>è¿™å­¦æœŸé€‰äº†ä¸€é—¨æ·±åº¦å¼ºåŒ–å­¦ä¹ ï¼Œä¹Ÿæ­£å¥½è¶æ­¤æœºä¼šç³»ç»Ÿæ€§è´¨åœ°æŠŠå¼ºåŒ–å­¦ä¹ ç†è®ºåŸºç¡€è¿‡ä¸€ä¸‹ï¼Œå¦‚æœå¯ä»¥çš„è¯å¯èƒ½è¿˜æ‰“ç®—è¿‡ä¸€ä¸‹æ·±åº¦å­¦ä¹ åŸºç¡€æ‰©å±•ä¸€ä¸‹è§†é‡ä¹‹ç±»çš„ã€‚</p>
<span id="more"></span>
<p><span class="math display"></span></p>
<h1
id="å¼ºåŒ–å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µä¸åŸºæœ¬ä¼˜åŒ–ç†è®º">å¼ºåŒ–å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µä¸åŸºæœ¬ä¼˜åŒ–ç†è®º</h1>
<h2 id="ç¯å¢ƒä¸ç­–ç•¥">ç¯å¢ƒä¸ç­–ç•¥</h2>
<p>å¼ºåŒ–å­¦ä¹ çš„åŸºæœ¬æ¡†æ¶ä¸ºä¸€ä¸ªæ™ºèƒ½ä½“å’Œç¯å¢ƒäº¤äº’ï¼Œç¯å¢ƒå¯¹æ™ºèƒ½ä½“çš„å†³ç­–ç»™å‡ºåé¦ˆï¼Œå³æ”¶ç›Šä¿¡å·å¹¶è½¬ç§»åˆ°ä¸‹ä¸€çŠ¶æ€ï¼Œæ™ºèƒ½ä½“éœ€è¦å­¦ä¼šåœ¨ä¸åŒçš„çŠ¶æ€ä¸‹åº”è¯¥åšå‡ºä½•ç§å†³ç­–ä»¥æ”¶è·æœ€é«˜æ€»æ”¶ç›Šã€‚</p>
<p>è¿™é‡Œç¯å¢ƒå¸¸å¸¸å»ºæ¨¡ä¸º Markov å†³ç­–è¿‡ç¨‹ï¼Œå³ MDP <span
class="math inline">$(\S, \A, \Pe, r, \gamma)$</span>ã€‚æ‰€è°“ Markov
è¿‡ç¨‹ï¼ŒæŒ‡çš„æ˜¯çŠ¶æ€è½¬ç§»å’Œå†å²çŠ¶æ€æ— å…³ï¼Œä»…ä»…å’Œå½“å‰çŠ¶æ€æœ‰å…³ï¼Œå¯ä»¥ç®€å•æè¿°ä¸º
<span class="math inline">$\P(s_{t + 1} \mid s_t) = \P(s_{t + 1} \mid
s_t, s_{t - 1}, \cdots, s_1)$</span>ã€‚MDP ä¸­å„é¡¹æŒ‡çš„æ˜¯ï¼š</p>
<ul>
<li>çŠ¶æ€ç©ºé—´ <span
class="math inline">$\S$</span>ã€‚å³ç¯å¢ƒå¯ä»¥è¡¨ç°å‡ºçš„æ‰€æœ‰çŠ¶æ€æ„æˆçš„é›†åˆã€‚</li>
<li>å†³ç­–ç©ºé—´ <span
class="math inline">$\A$</span>ã€‚å³ç¯å¢ƒå…è®¸æ™ºèƒ½ä½“åšå‡ºçš„æ‰€æœ‰å†³ç­–æ„æˆçš„é›†åˆã€‚</li>
<li>çŠ¶æ€è½¬ç§»æ¦‚ç‡å‡½æ•° <span class="math inline">$\Pe$</span>ã€‚<span
class="math inline">$\Pe(s' \mid s, a)$</span> è¡¨ç¤ºç¯å¢ƒåœ¨çŠ¶æ€ <span
class="math inline">$s \in \S$</span> ä¸”æ™ºèƒ½ä½“åšå‡ºå†³ç­– <span
class="math inline">$a \in \A$</span> çš„æ—¶å€™ç¯å¢ƒä¸‹ä¸€æ­¥è½¬ç§»åˆ°çŠ¶æ€ <span
class="math inline">$s' \in \S$</span> çš„æ¦‚ç‡ã€‚è¿™é‡Œä¸‹æ ‡ <span
class="math inline">â„°</span> è¡¨ç¤ºè¯¥æ¦‚ç‡ä»…ä¸ç¯å¢ƒ <span
class="math inline">â„°</span> æœ¬èº«æœ‰å…³ã€‚å…¶ä¸€èˆ¬ç§°ä¸º model æˆ–è€…
dynamicsã€‚</li>
<li>æ”¶ç›Šå‡½æ•° <span class="math inline"><em>r</em></span>ã€‚æ”¶ç›Šå‡½æ•°ä¸ºä»
<span class="math inline">$\S \times \A \times \S$</span> åˆ° <span
class="math inline">$\R$</span> çš„æ˜ å°„ã€‚<span
class="math inline"><em>r</em>(<em>s</em>,<em>a</em>,<em>s</em>â€²)</span>
è¡¨ç¤ºç¯å¢ƒåœ¨çŠ¶æ€ <span class="math inline">$s \in \S$</span>
ä¸”æ™ºèƒ½ä½“åšå‡ºå†³ç­– <span class="math inline">$a \in \A$</span>
å¹¶è½¬ç§»åˆ°æ–°çŠ¶æ€ <span class="math inline">$s' \in \S$</span>
çš„æ—¶å€™ç¯å¢ƒç»™äºˆæ™ºèƒ½ä½“çš„æ”¶ç›Šã€‚</li>
<li>æ”¶ç›Šè¡°å‡ç³»æ•° <span class="math inline"><em>Î³</em></span>ã€‚è¿™é‡Œ <span
class="math inline"><em>Î³</em>â€„âˆˆâ€„[0,1]</span>ã€‚è¯¥å‚æ•°ä»£è¡¨æ”¶ç›Šéšç€æ—¶é—´æ­¥è¡°å‡çš„ç³»æ•°ï¼Œå…·ä½“å«ä¹‰å°†ä¼šåœ¨åç»­å®šä¹‰ç´¯è®¡æ”¶ç›Šçš„æ—¶å€™å±•å¼€ã€‚</li>
</ul>
<p>å¦å¤–éœ€è¦è¯´æ˜çš„æ˜¯ï¼ŒçŠ¶æ€ <span class="math inline">$s \in \S$</span>
å¯èƒ½å¹¶ä¸æ˜¯å®Œå…¨å¯ä»¥è§‚æµ‹çš„ï¼Œå¦‚æœ <span
class="math inline"><em>s</em></span> ä¸èƒ½å®Œå…¨è§‚æµ‹ï¼Œæˆ‘ä»¬ä¼šå°† <span
class="math inline"><em>s</em></span> ä¸­èƒ½è§‚æµ‹çš„éƒ¨åˆ†è®°ä½œ <span
class="math inline"><em>o</em></span>ï¼Œç§°ä¸º<strong>è§‚æµ‹</strong>ï¼Œå³
observationã€‚æ‰€æœ‰è§‚æµ‹æ„æˆçš„é›†åˆè®°ä½œ <span
class="math inline">ğ’ª</span>ã€‚è¿™ç§éƒ¨åˆ†å¯ä»¥è§‚æµ‹çš„ MDP ç§°ä¸º
<strong>P</strong>artially <strong>O</strong>bservable MDPï¼Œç¼©å†™
POMDPã€‚</p>
<p>è€Œæ™ºèƒ½ä½“å†…éƒ¨æ‰€ä½¿ç”¨çš„ç­–ç•¥ä¸€èˆ¬è¡¨ç°ä¸º <span
class="math inline"><em>Ï€</em>(<em>a</em>âˆ£<em>s</em>)</span>ï¼Œå…¶è¡¨ç¤ºäº†æ™ºèƒ½ä½“åœ¨è¯¥ç­–ç•¥æ¡ä»¶ä¸‹ï¼Œåœ¨çŠ¶æ€
<span class="math inline"><em>s</em></span> æ—¶åšå‡ºå†³ç­– <span
class="math inline"><em>a</em></span> çš„æ¦‚ç‡ã€‚</p>
<p>ä¸Šè¿°çš„ç­–ç•¥å¾€å¾€ç§°ä¸º<strong>éç¡®å®šæ€§ç­–ç•¥</strong>ï¼Œå› ä¸ºå…¶å¯¹äºæŸä¸ªçŠ¶æ€ç»™å‡ºçš„æ˜¯åšå‡ºæŸä¸€ç§å†³ç­–çš„æ¦‚ç‡ï¼Œæ˜¯ä¸ç¡®å®šçš„ã€‚è€Œå¦å¤–ä¸€ç±»ç­–ç•¥ï¼Œå³<strong>ç¡®å®šæ€§ç­–ç•¥</strong>ï¼Œä¼šå¯¹äºæŸä¸ªçŠ¶æ€ç»™å‡ºå…·ä½“çš„æŸä¸€ç§å†³ç­–ã€‚ç¡®å®šæ€§ç­–ç•¥çš„è®°å·ï¼Œä¸ºäº†å’Œéç¡®å®šæ€§ç­–ç•¥çš„
<span class="math inline"><em>Ï€</em></span> åŒºåˆ«ï¼Œå¾€å¾€ä½¿ç”¨ <span
class="math inline"><em>Î¼</em></span>ã€‚è€Œ <span
class="math inline"><em>a</em>â€„:=â€„<em>Î¼</em>(<em>s</em>)</span>
å°±è¡¨ç¤ºäº†æ™ºèƒ½ä½“åœ¨è¯¥ç­–ç•¥æ¡ä»¶ä¸‹ï¼Œåœ¨çŠ¶æ€ <span
class="math inline"><em>s</em></span> æ—¶ä¼šåšå‡ºå†³ç­– <span
class="math inline"><em>a</em></span>ã€‚</p>
<p>ä¸€æ¡<strong>è½¨è¿¹ï¼ˆTrajectoryï¼‰</strong>ï¼ŒæŒ‡çš„æ˜¯æ™ºèƒ½ä½“å’Œç¯å¢ƒä¸æ–­äº¤äº’çš„è¿‡ç¨‹çš„è®°å½•ã€‚å…·ä½“è€Œè¨€ï¼Œç¯å¢ƒé¦–å…ˆä½äºçŠ¶æ€
<span class="math inline"><em>s</em><sub>0</sub></span>ï¼Œæ™ºèƒ½ä½“åšå‡ºå†³ç­–
<span class="math inline"><em>a</em><sub>0</sub></span>ï¼Œç¯å¢ƒè¿”å›æ”¶ç›Š
<span class="math inline"><em>r</em><sub>1</sub></span> åè½¬å…¥æ–°çŠ¶æ€
<span class="math inline"><em>s</em><sub>1</sub></span>ã€‚ä»¥æ­¤ç±»æ¨å½¢æˆ
<span
class="math inline"><em>s</em><sub>0</sub>,â€†<em>a</em><sub>0</sub>,â€†<em>r</em><sub>1</sub>;â€†<em>s</em><sub>1</sub>,â€†<em>a</em><sub>1</sub>,â€†<em>r</em><sub>2</sub>;â€†â‹¯</span>ã€‚è½¨è¿¹å¸¸å¸¸ä½¿ç”¨è®°å·
<span class="math inline"><em>Ï„</em></span> è¡¨ç¤ºã€‚</p>
<p>æ˜¾ç„¶æ ¹æ® Markov çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°åœ¨ç­–ç•¥ <span
class="math inline"><em>Ï€</em></span> çš„æ¡ä»¶ä¸‹æŸä¸€æ¡è½¨è¿¹ <span
class="math inline"><em>Ï„</em>â€„=â€„(<em>s</em><sub>0</sub>,<em>a</em><sub>0</sub>,<em>r</em><sub>1</sub>;<em>s</em><sub>1</sub>,<em>a</em><sub>1</sub>,<em>r</em><sub>2</sub>;â‹¯)</span>
å‡ºç°çš„æ¦‚ç‡ä¸ºï¼š</p>
<p><span class="math display">$$
\P_\pi(\tau) = \Pe(s_0)\prod_{t = 0}^{+\infty} \pi(a_t \mid s_t)\Pe(s_{t
+ 1} \mid s_t, a_t)
$$</span></p>
<p>è¿™é‡Œ <span class="math inline">$\Pe(s_0)$</span> è¡¨ç¤ºç¯å¢ƒåˆå§‹çŠ¶æ€ä¸º
<span class="math inline"><em>s</em><sub>0</sub></span> çš„æ¦‚ç‡ã€‚</p>
<p>æˆ‘ä»¬è¡¨ç¤ºè½¨è¿¹ <span class="math inline"><em>Ï„</em></span>
æœä»ä¸Šè¿°æ¦‚ç‡åˆ†å¸ƒçš„æ—¶å€™ï¼Œå¯ä»¥å†™æˆå¤šç§ç¬¦å·ï¼ŒåŒ…æ‹¬ <span
class="math inline">$\tau \sim \P_\pi(\tau)$</span> æˆ–è€… <span
class="math inline"><em>Ï„</em>â€„âˆ¼â€„<em>Ï€</em></span>
ç­‰ç­‰ï¼Œæœ¬æ–‡ä¼šä½¿ç”¨ç¬¬äºŒç§è¡¨è¾¾ã€‚</p>
<h2 id="ç´¯è®¡æ”¶ç›Šä¸ä»·å€¼å‡½æ•°">ç´¯è®¡æ”¶ç›Šä¸ä»·å€¼å‡½æ•°</h2>
<p>å¯¹ä¸€æ¡è½¨è¿¹ï¼Œ<strong>ç´¯è®¡æ”¶ç›Šï¼ˆUtilityï¼‰</strong>çš„å®šä¹‰ä¸ºï¼š</p>
<p><span class="math display">$$
G_t(\tau) := \sum_{k = 0}^{+\infty} \gamma^k r_{t + k + 1}
$$</span></p>
<p>å…¶ä¸­ <span class="math inline"><em>t</em>â€„=â€„0</span> æ—¶ï¼Œ<span
class="math inline"><em>G</em><sub>0</sub></span> å¯ä»¥ç®€å†™ä¸º <span
class="math inline"><em>G</em></span>ã€‚</p>
<p>è¿™é‡Œæ³¨æ„åˆ°æˆ‘ä»¬ç´¯åŠ æ”¶ç›Šçš„æ—¶å€™éœ€è¦ä¸æ–­ä½¿ç”¨è¡°å‡å› å­è¿›è¡Œè¡°å‡ï¼Œè¿™ä¸€æ“ä½œä¸»è¦æ˜¯ä¸ºäº†æ‹Ÿåˆç°å®ä¸­è·ç¦»ç°åœ¨è¶Šè¿œçš„è¡Œä¸ºå¯¹å½“å‰å†³ç­–çš„å½±å“è¶Šå°çš„ç‰¹å¾ï¼Œè¿™ä¸€æ“ä½œåŒæ—¶ä¹Ÿä¿è¯äº†æ”¶æ•›æ€§ã€‚</p>
<p>ä¹‹åï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥å®šä¹‰<strong>ä»·å€¼å‡½æ•°</strong>ã€‚é¦–å…ˆéœ€è¦å®šä¹‰<strong>çŠ¶æ€è¡Œä¸ºä»·å€¼å‡½æ•°</strong>ï¼š</p>
<p><span class="math display">$$
Q^\pi(s, a) := \Eop_{\tau \sim \pi}[G(\tau) \mid s_0 = s, a_0 = a]
$$</span></p>
<p>è¿›ä¸€æ­¥å³å¯æœ‰<strong>çŠ¶æ€ä»·å€¼å‡½æ•°</strong>ï¼š</p>
<p><span class="math display">$$
V^\pi(s) := \Eop_{\tau \sim \pi}[G(\tau) \mid s_0 = s]
$$</span></p>
<p>æˆ‘ä»¬å¯ä»¥å‘ç°çŠ¶æ€è¡Œä¸ºä»·å€¼å‡½æ•°æè¿°äº†åœ¨çŠ¶æ€ <span
class="math inline"><em>s</em></span> ä¸‹åšå‡ºå†³ç­– <span
class="math inline"><em>a</em></span>
åæœŸæœ›çš„ç´¯è®¡æ”¶ç›Šï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥ä»·å€¼å‡½æ•°è¯„ä»·äº†ç»™å®šçŠ¶æ€ä¸‹çš„æŸä¸ªå†³ç­–çš„æœŸæœ›æ”¶ç›Šï¼Œæ‰€ä»¥æˆ‘ä»¬å¸¸å¸¸ä½¿ç”¨çŠ¶æ€è¡Œä¸ºä»·å€¼å‡½æ•°è¾…åŠ©å†³ç­–ã€‚è€ŒçŠ¶æ€ä»·å€¼å‡½æ•°åˆ™å’Œå…·ä½“çš„å†³ç­–æ— å…³ï¼Œæ˜¯è¡¡é‡ä»æŸä¸€ä¸ªçŠ¶æ€å‡ºå‘ï¼Œèƒ½å¤Ÿè·å¾—çš„æœŸæœ›æ”¶ç›Šã€‚</p>
<p>æ˜¾ç„¶è¿™ä¸¤ä¸ªä»·å€¼å‡½æ•°ä¹‹é—´å­˜åœ¨ç›¸äº’æ¨å‡ºå…³ç³»ï¼Œè€Œè¿™ç§å…³ç³»æè¿°å¦‚ä¸‹ï¼š</p>
<div class="note info no-icon"><p><strong>Theorem 1.01</strong> å¯¹äºä»»ä½• MDP ä¸å…¶ä¸Šçš„ç­–ç•¥ <span
class="math inline"><em>Ï€</em></span>ï¼Œè¯¥ç­–ç•¥çš„çŠ¶æ€ä»·å€¼å‡½æ•°ä¸çŠ¶æ€è¡Œä¸ºä»·å€¼å‡½æ•°æ»¡è¶³ï¼š</p>
<p><span class="math display">$$
\begin{aligned}
{\color{red} V^\pi(s)} &amp;= \sum_{a \in \A} \pi(a \mid s){\color{red}
Q^\pi(s, a)} \\
{\color{red} Q^\pi(s, a)} &amp;= \sum_{s' \in \S} \Pe(s' \mid s, a)[r(s,
a, s') + \gamma {\color{red} V^\pi(s')}] \\
\end{aligned}
$$</span></p>
</div>
<p>ç¬¬ä¸€ä¸ªç­‰å¼æ˜¯ç”± <span
class="math inline"><em>Q</em><sup><em>Ï€</em></sup></span> æ¨å‡º <span
class="math inline"><em>V</em><sup><em>Ï€</em></sup></span>
çš„è·¯å¾„ï¼Œè¯æ˜ä¹Ÿæ˜¯ç®€å•çš„ï¼š</p>
<p><span class="math display">$$
\begin{aligned}
V^\pi(s) &amp;= \Eop_{\tau \sim \pi}[G(\tau) \mid s_0 = s] \\
&amp;= \sum_{\tau} \P_\pi(\tau \mid s_0 = s)G(\tau) \\
&amp;= \sum_{\tau} \left(\sum_{a \in \A} \P_\pi(\tau, a_0 = a \mid s_0 =
s)\right)G(\tau) \\
&amp;= \sum_{\tau} \left(\sum_{a \in \A} \P_\pi(\tau \mid s_0 = s, a_0 =
a)\P_\pi(a_0 = a \mid s_0 = s)\right)G(\tau) \\
&amp;= \sum_{a \in \A} \P_\pi(a_0 = a \mid s_0 = s) \left(\sum_{\tau}
\P_\pi(\tau \mid s_0 = s, a_0 = a) G(\tau)\right) \\
&amp;= \sum_{a \in \A} \pi(a \mid s)\Eop_{\tau \sim \pi}[G(\tau) \mid
s_0 = s, a_0 = a] \\
&amp;= \sum_{a \in \A} \pi(a \mid s)Q^\pi(s, a) \\
\end{aligned}
$$</span></p>
<p>ç¬¬äºŒä¸ªç­‰å¼æ˜¯ç”± <span
class="math inline"><em>V</em><sup><em>Ï€</em></sup></span> æ¨å‡º <span
class="math inline"><em>Q</em><sup><em>Ï€</em></sup></span>
çš„è·¯å¾„ï¼Œå…¶æ¶‰åŠåˆ°äº†åç»­çŠ¶æ€ï¼Œä»è€Œå®é™…ä¸Šæè¿°å‡ºäº†ä»·å€¼å‡½æ•°ä¹‹é—´çš„é€’æ¨å…³ç³»ã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘å…¶è¯æ˜ï¼Œé¦–å…ˆæˆ‘ä»¬æ˜¾ç„¶æœ‰è¿™ä¸ªç­‰å¼ï¼š</p>
<p><span class="math display">$$
r(s, a, s') = \Eop_{\tau \sim \pi}[r_1 \mid s_0 = s, a_0 = a, s_1 = s']
$$</span></p>
<p>ä¹‹åè€ƒè™‘å¯¹çŠ¶æ€è¡Œä¸ºä»·å€¼å‡½æ•°çš„å•æ­¥å±•å¼€ï¼š</p>
<p><span class="math display">$$
\begin{aligned}
Q^\pi(s) &amp;= \Eop_{\tau \sim \pi}[G(\tau) \mid s_0 = s, a_0 = a] \\
&amp;= \Eop_{\tau \sim \pi}\left[\sum_{k = 0}^{+\infty} \gamma^k r_{k +
1} \middle| s_0 = s, a_0 = a\right] \\
&amp;= \Eop_{\tau \sim \pi}\left[r_1 + \sum_{k = 1}^{+\infty} \gamma^k
r_{k + 1} \middle| s_0 = s, a_0 = a\right] \\
&amp;= \Eop_{\tau \sim \pi}\left[r_1 + \gamma\sum_{k = 0}^{+\infty}
\gamma^k r_{k + 2} \middle| s_0 = s, a_0 = a\right] \\
&amp;= \Eop_{\tau \sim \pi}[r_1 \mid s_0 = s, a_0 = a] + \Eop_{\tau \sim
\pi}\left[\gamma\sum_{k = 0}^{+\infty} \gamma^k r_{k + 2} \middle| s_0 =
s, a_0 = a\right] \\
&amp;= \Eop_{\tau \sim \pi}[r_1 \mid s_0 = s, a_0 = a] +
\gamma\Eop_{\tau \sim \pi}[G_1(\tau) \mid s_0 = s, a_0 = a] \\
\end{aligned}
$$</span></p>
<p>ä¹‹åæˆ‘ä»¬ä½¿ç”¨å…¨æœŸæœ›å…¬å¼å¤„ç†æ¡ä»¶æœŸæœ›ä¸­çš„æ¡ä»¶ï¼š</p>
<p><span class="math display">$$
\begin{aligned}
\Eop_{\tau \sim \pi}[r_1 \mid s_0 = s, a_0 = a] &amp;= \sum_{s' \in \S}
\Pe(s' \mid s, a) \Eop_{\tau \sim \pi}[r_1 \mid s_0 = s, a_0 = a, s_1 =
s'] \\
&amp;= \sum_{s' \in \S} \Pe(s' \mid s, a)r(s, a, s') \\
\Eop_{\tau \sim \pi}[G_1(\tau) \mid s_0 = s, a_0 = a] &amp;= \sum_{s'
\in \S} \Pe(s' \mid s, a) \Eop_{\tau \sim \pi}[G_1(\tau) \mid s_0 = s,
a_0 = a, s_1 = s'] \\
&amp;= \sum_{s' \in \S} \Pe(s' \mid s, a) \Eop_{\tau \sim \pi}[G_1(\tau)
\mid s_1 = s'] \\
&amp;= \sum_{s' \in \S} \Pe(s' \mid s, a)V^\pi(s') \\
\end{aligned}
$$</span></p>
<p>è¿™é‡Œæ³¨æ„åˆ°å¤„ç†ç¬¬äºŒä¸ªæ¡ä»¶æœŸæœ›çš„æ—¶å€™ï¼Œç›´æ¥åˆ å»äº† <span
class="math inline"><em>s</em><sub>0</sub>â€„=â€„<em>s</em></span> å’Œ <span
class="math inline"><em>a</em><sub>0</sub>â€„=â€„<em>a</em></span>
ä¸¤ä¸ªæ¡ä»¶ï¼Œè¿™æ˜¯å› ä¸º <span
class="math inline"><em>G</em><sub>1</sub>(<em>Ï„</em>)</span> ä¸ <span
class="math inline"><em>s</em><sub>0</sub>,â€†<em>a</em><sub>0</sub></span>
æ— å…³ï¼Œå¯ä»¥ç›´æ¥åˆ å»è€Œä¸å½±å“æœ€åçš„æœŸæœ›ã€‚</p>
<p>å°†æ­¤ä»£å…¥åŸæœ‰å±•å¼€å¼å³å¯è¯æ˜å®Œæ¯•ã€‚</p>
<p>äº‹å®ä¸Šï¼ŒåŸºäºè¿™ä¸¤ä¸ªä»·å€¼å‡½æ•°çš„äº’ç›¸æ¨å‡ºï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ° <span
class="math inline"><em>Q</em><sup><em>Ï€</em></sup></span> æ¨å‡º <span
class="math inline"><em>Q</em><sup><em>Ï€</em></sup></span> çš„å…¬å¼ï¼š</p>
<p><span class="math display">$$
{\color{red} Q^\pi(s, a)} = \sum_{s' \in \S} \Pe(s' \mid s, a)
\left[r(s, a, s') + \gamma\sum_{a' \in \A} \pi(a' \mid s'){\color{red}
Q^\pi(s', a')}\right]
$$</span></p>
<p>ä»¥åŠ <span class="math inline"><em>V</em><sup><em>Ï€</em></sup></span>
æ¨å‡º <span class="math inline"><em>V</em><sup><em>Ï€</em></sup></span>
çš„å…¬å¼ï¼š</p>
<p><span class="math display">$$
{\color{red} V^\pi(s)} = \sum_{a \in \A} \pi(a \mid s) \sum_{s' \in \S}
\Pe(s' \mid s, a)[r(s, a, s') + \gamma {\color{red} V^\pi(s')}]
$$</span></p>
<p>è¿™ä¸¤ä¸ªå…¬å¼ç›´æ¥è¡¨ç°å‡ºäº†ä»·å€¼å‡½æ•°è‡ªèº«å…·æœ‰çš„è¿­ä»£ç»“æ„ï¼Œä¹Ÿå°±æ˜¯å½“å‰å¼ºåŒ–å­¦ä¹ ä¸­æœ€ä¸ºé‡è¦çš„æ–¹ç¨‹ä¹‹ä¸€ï¼Œç›®å‰å¤§éƒ¨åˆ†å¼ºåŒ–å­¦ä¹ æ–¹æ³•çš„æ ¸å¿ƒå°±æ˜¯æ‹Ÿåˆè¯¥æ–¹ç¨‹ã€‚è¯¥æ–¹ç¨‹å³
<strong>Bellman æ–¹ç¨‹ï¼ˆBellman Equationï¼‰</strong>ã€‚</p>
<h2 id="åŸºæœ¬ä¼˜åŒ–ç†è®º">åŸºæœ¬ä¼˜åŒ–ç†è®º</h2>
<p>ç°åœ¨æˆ‘ä»¬è®¨è®ºå¦‚ä½•è·å–ä¸€ä¸ªæœ€æœ‰ä»·å€¼çš„ç­–ç•¥ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰<strong>æœ€ä¼˜çŠ¶æ€è¡Œä¸ºä»·å€¼å‡½æ•°</strong>å’Œ<strong>æœ€ä¼˜çŠ¶æ€ä»·å€¼å‡½æ•°</strong>ï¼š</p>
<p><span class="math display">$$
\begin{aligned}
Q^\star(s, a) &amp;:= \max_\pi Q^\pi(s, a) \\
V^\star(s) &amp;:= \max_\pi V^\pi(s) \\
\end{aligned}
$$</span></p>
<p>åŸºäºæœ€ä¼˜æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ç­–ç•¥ä¹‹é—´çš„åºã€‚æˆ‘ä»¬ç§°ç­–ç•¥ <span
class="math inline"><em>Ï€</em></span> ä¼˜äº <span
class="math inline"><em>Ï€</em>â€²</span>ï¼Œè®°ä½œ <span
class="math inline"><em>Ï€</em>â€„â‰¥â€„<em>Ï€</em>â€²</span>ï¼Œå½“ä¸”ä»…å½“å¯¹äºæ‰€æœ‰
<span class="math inline">$s \in \S$</span> éƒ½æ»¡è¶³ <span
class="math inline"><em>Ï€</em></span> çš„çŠ¶æ€å‡½æ•°ä¼˜äº <span
class="math inline"><em>Ï€</em>â€²</span>ï¼Œå³ <span
class="math inline"><em>V</em><sup><em>Ï€</em></sup>(<em>s</em>)â€„â‰¥â€„<em>V</em><sup><em>Ï€</em>â€²</sup>(<em>s</em>)</span>ã€‚</p>
<p>æˆ‘ä»¬æœ‰ä¸‹è¿°åŸºæœ¬ä¼˜åŒ–ç†è®ºï¼š</p>
<div class="note info no-icon"><p><strong>Theorem 1.02</strong> å¯¹äºä»»ä½• MDPï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªæœ€ä¼˜ç­–ç•¥ <span
class="math inline"><em>Ï€</em><sup>â‹†</sup></span> æ»¡è¶³å¯¹äºä»»ä½• <span
class="math inline"><em>Ï€</em></span> éƒ½æœ‰ <span
class="math inline"><em>Ï€</em><sup>â‹†</sup>â€„â‰¥â€„<em>Ï€</em></span>ã€‚å¹¶ä¸”è¯¥æœ€ä¼˜ç­–ç•¥
<span class="math inline"><em>Ï€</em><sup>â‹†</sup></span>
åœ¨åœ¨ä»»ä½•çŠ¶æ€ä¸ä»»ä½•å†³ç­–ä¸‹å‡å®ç°äº†æœ€ä¼˜ä»·å€¼ï¼Œå³å¯¹äºä»»ä½• <span
class="math inline">$s \in \S, a \in \A$</span> éƒ½æœ‰ <span
class="math inline"><em>V</em><sup><em>Ï€</em><sup>â‹†</sup></sup>(<em>s</em>)â€„=â€„<em>V</em><sup>â‹†</sup>(<em>s</em>),â€†<em>Q</em><sup><em>Ï€</em><sup>â‹†</sup></sup>(<em>s</em>,<em>a</em>)â€„=â€„<em>Q</em><sup>â‹†</sup>(<em>s</em>,<em>a</em>)</span>ã€‚</p>
</div>
<p>æœ¬æ–‡ä¸åŠ è¯æ˜åœ°è®¤ä¸ºè¯¥ç†è®ºæˆç«‹ã€‚å¦å¤–ï¼Œè¿™é‡Œç»™å‡ºæœ€ä¼˜ç­–ç•¥çš„æ„é€ ã€‚å¯è§æœ€ä¼˜ç­–ç•¥æ˜¯ç¡®å®šæ€§ç­–ç•¥ï¼š</p>
<p><span class="math display">$$
\pi^\star(a \mid s) := \begin{cases}
1 &amp; a = \argmax_{a \in \A} Q^\star(s, a) \\
0 &amp; \text{otherwise}
\end{cases}
$$</span></p>
<p>åŸºäºè¯¥å®šç†æˆ‘ä»¬èƒ½å¤Ÿå¾—åˆ°ä¸¤ä¸ªæœ€ä¼˜ä»·å€¼å‡½æ•°ä¹‹é—´å­˜åœ¨çš„å…³ç³»ï¼š</p>
<div class="note info no-icon"><p><strong>Theorem 1.03</strong> å¯¹äºä»»ä½•
MDPï¼Œå…¶æœ€ä¼˜çŠ¶æ€ä»·å€¼å‡½æ•°ä¸æœ€ä¼˜çŠ¶æ€è¡Œä¸ºä»·å€¼å‡½æ•°æ»¡è¶³ï¼š</p>
<p><span class="math display">$$
\begin{aligned}
{\color{red} V^\star(s)} &amp;= \max_{a \in \A} {\color{red} Q^\star(s,
a)} \\
{\color{red} Q^\star(s, a)} &amp;= \sum_{s' \in \S} \Pe(s' \mid s,
a)[r(s, a, s') + \gamma {\color{red} V^\star(s')}] \\
\end{aligned}
$$</span></p>
</div>
<p>ç¬¬ä¸€ä¸ªç­‰å¼æ˜¯ç®€å•çš„ï¼š</p>
<p><span class="math display">$$
V^\star(s) = V^{\pi^\star}(s) = \sum_{a \in \A} \pi^\star(a \mid
s)Q^{\pi^\star}(s, a) = \max_{a \in \A} Q^{\pi^\star}(s, a) = \max_{a
\in \A} Q^\star(s, a)
$$</span></p>
<p>ç¬¬äºŒä¸ªç­‰å¼ç›´æ¥å¯¹ <span
class="math inline"><em>Ï€</em><sup>â‹†</sup></span> åº”ç”¨ä¸€èˆ¬çš„ Bellman
æ–¹ç¨‹å³å¯å¾—åˆ°ã€‚</p>
<p>ä»è€Œè¿˜æœ‰ä¸‹è¿°<strong>æœ€ä¼˜ Bellman æ–¹ç¨‹ï¼ˆBellman Optimality
Equationï¼‰</strong>ï¼š</p>
<p><span class="math display">$$
{\color{red} Q^\star(s, a)} = \sum_{s' \in \S} \Pe(s' \mid s, a)
\left[r(s, a, s') + \gamma\max_{a' \in \A} {\color{red} Q^\star(s',
a')}\right]
$$</span></p>
<p>ä»¥åŠï¼š</p>
<p><span class="math display">$$
{\color{red} V^\star(s)} = \max_{a \in \A} \left[\sum_{s' \in \S} \Pe(s'
\mid s, a)[r(s, a, s') + \gamma {\color{red} V^\star(s')}]\right]
$$</span></p>
<p>ç†è®ºä¸Šæˆ‘ä»¬å¯ä»¥æ±‚è§£æœ€ä¼˜ Bellman æ–¹ç¨‹å¾—åˆ° <span
class="math inline"><em>V</em><sup>â‹†</sup></span>ï¼Œä»è€Œå°±èƒ½å¤Ÿåæ¨å‡º
<span class="math inline"><em>Ï€</em><sup>â‹†</sup></span>ã€‚ç„¶è€Œæ±‚è§£æœ€ä¼˜
Bellman æ–¹ç¨‹æ˜¯è®¡ç®—å›°éš¾çš„ï¼Œç°è¡Œçš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•å°±æ˜¯åœ¨å°è¯•è¿‘ä¼¼æ±‚è§£æœ€ä¼˜
Bellman æ–¹ç¨‹ã€‚</p>
<h1 id="åŸºäºå®Œå…¨ç¯å¢ƒçŸ¥è¯†çš„-rl-æ–¹æ³•">åŸºäºå®Œå…¨ç¯å¢ƒçŸ¥è¯†çš„ RL æ–¹æ³•</h1>
<p>å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿå®Œå…¨æŒæ¡ç¯å¢ƒï¼Œå³å®Œå…¨æŒæ¡è½¬ç§»æ¦‚ç‡ <span
class="math inline">$\Pe$</span> å’Œæ”¶ç›Šå‡½æ•° <span
class="math inline"><em>r</em></span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>åŠ¨æ€è§„åˆ’ï¼ˆDynamic
Programming, DPï¼‰</strong>æ¥æ±‚è§£æœ€ä¼˜ç­–ç•¥ã€‚DP
æ–¹æ³•æœ‰ä¸¤ç§ç±»åˆ«ï¼Œåˆ†åˆ«æ˜¯<strong>ç­–ç•¥è¿­ä»£ï¼ˆPolicy Iteration,
PIï¼‰</strong>å’Œ<strong>å€¼è¿­ä»£ï¼ˆValue Iteration, VIï¼‰</strong>ã€‚</p>
<h2 id="policy-iteration-pi">Policy Iteration (PI)</h2>
<p>å¦‚æœæˆ‘ä»¬å·²ç»å¯¹ç¯å¢ƒæœ‰äº†å®Œæ•´çš„å»ºæ¨¡ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ä½¿ç”¨è¿­ä»£çš„æ–¹å¼æ±‚è§£æœ€ä¼˜
Bellman æ–¹ç¨‹ã€‚</p>
<p>å…·ä½“çš„è¿­ä»£è¿‡ç¨‹åˆ†ä¸ºä¸¤æ­¥ï¼Œåˆ†åˆ«ä¸º<strong>ç­–ç•¥è¯„ä¼°ï¼ˆPolicy
Evaluationï¼‰</strong>å’Œ<strong>ç­–ç•¥æå‡ï¼ˆPolicy
Improvementï¼‰</strong>ï¼Œè¿™ä¸¤æ­¥ä¼šäº¤æ›¿è¿›è¡Œã€‚å…·ä½“è€Œè¨€ï¼Œç­–ç•¥è¯„ä¼°æ˜¯åœ¨å·²çŸ¥
<span class="math inline"><em>Ï€</em></span> çš„æ¡ä»¶ä¸‹è®¡ç®—å…¶çŠ¶æ€ä»·å€¼å‡½æ•°
<span
class="math inline"><em>V</em><sup><em>Ï€</em></sup></span>ã€‚è€Œç­–ç•¥æå‡ä¸ºåœ¨å¾—çŸ¥çŠ¶æ€ä»·å€¼å‡½æ•°çš„åŸºç¡€ä¸Šä¼˜åŒ–ç­–ç•¥
<span class="math inline"><em>Ï€</em></span>ã€‚</p>
<p>é¦–å…ˆé˜è¿°ç­–ç•¥è¯„ä¼°çš„è¿‡ç¨‹ï¼Œè¿™é‡Œä¸¾å‡ºä¸€ä¸ªè¿­ä»£è®¡ç®—çš„æ–¹å¼ã€‚</p>
<p>æˆ‘ä»¬è®° <span
class="math inline"><em>V</em><sub><em>k</em></sub></span> æ˜¯ç¬¬ <span
class="math inline"><em>k</em></span>
è½®è¿­ä»£çš„æ—¶å€™çš„çŠ¶æ€ä»·å€¼å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨åˆå§‹åŒ– <span
class="math inline"><em>V</em><sub>0</sub></span>
ä¹‹åä¸æ–­è¿›è¡Œä¸‹è¿°è¿­ä»£ç›´åˆ°çŠ¶æ€ä»·å€¼å‡½æ•°æ”¶æ•›ï¼š</p>
<p><span class="math display">$$
V_{k + 1}(s) \leftarrow \sum_{a \in \A} \pi(a \mid s) \sum_{s' \in \S}
\Pe(s' \mid s, a)[r(s, a, s') + \gamma V_k(s')]
$$</span></p>
<p>æ”¶æ•›åï¼Œåº”å½“æœ‰ <span
class="math inline"><em>V</em><sub>+âˆ</sub>â€„=â€„<em>V</em><sup><em>Ï€</em></sup></span>ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å¾—åˆ°äº†ç­–ç•¥
<span class="math inline"><em>Ï€</em></span> æ‰€å¯¹åº”çš„ä»·å€¼å‡½æ•°ã€‚</p>
<p>ç­–ç•¥è¯„ä¼°é™¤äº†ä½¿ç”¨è¿­ä»£çš„æ–¹å¼è®¡ç®—ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ç­‰æ–¹å¼è®¡ç®—ï¼Œè¿™äº›æ–¹æ³•æˆ‘ä»¬ä¸å…·ä½“å±•å¼€ã€‚</p>
<p>ä¹‹åé˜è¿°ç­–ç•¥æå‡çš„æ–¹æ³•ã€‚</p>
<p>æˆ‘ä»¬åœ¨å¾—çŸ¥äº†ç­–ç•¥ <span class="math inline"><em>Ï€</em></span>
çš„çŠ¶æ€ä»·å€¼å‡½æ•° <span
class="math inline"><em>V</em><sup><em>Ï€</em></sup></span>
ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è´ªå¿ƒåœ°æ„é€ ä¸€ä¸ªç¡®å®šæ€§ç­–ç•¥ <span
class="math inline"><em>Ï€</em>â€²</span>ï¼Œä¿è¯ç­–ç•¥æ›´ä¼˜ã€‚ä¿è¯è¿™ä¸€ç‚¹èƒ½å¤Ÿæˆç«‹çš„æ˜¯ä¸‹è¿°å®šç†ï¼š</p>
<div class="note info no-icon"><p><strong>Theorem 2.01 (Policy Improvement Theorem)</strong>
å¯¹äºå·²çŸ¥çš„ç­–ç•¥ <span
class="math inline"><em>Ï€</em></span>ï¼Œå®šä¹‰ç¡®å®šæ€§ç­–ç•¥ <span
class="math inline"><em>Ï€</em>â€²</span>ï¼š</p>
<p><span class="math display">$$
\pi'(a \mid s) := \begin{cases}
1 &amp; a = \argmax_{a \in \A} Q^\pi(s, a) \\
0 &amp; \text{otherwise}
\end{cases}
$$</span></p>
<p>é‚£ä¹ˆ <span
class="math inline"><em>Ï€</em>â€²â€„â‰¥â€„<em>Ï€</em></span>ï¼Œå¹¶ä¸”ç­‰å·æˆç«‹å½“ä¸”ä»…å½“
<span
class="math inline"><em>Ï€</em>â€„=â€„<em>Ï€</em>â€²â€„=â€„<em>Ï€</em><sup>â‹†</sup></span>ã€‚</p>
</div>
<p>è¯æ˜æ˜¯ç®€å•çš„ï¼Œé¦–å…ˆæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ï¼š</p>
<p><span class="math display">$$
Q^\pi(s, \pi'(s)) = \max_{a \in \A} Q^\pi(s, a) \geq \sum_{a \in \A}
\pi(a \mid s)Q^\pi(s, a) = V^\pi(s)
$$</span></p>
<p>æˆ‘ä»¬ä»è€Œèƒ½å¾—åˆ°ä¸‹è¿°ä¸ç­‰å¼ã€‚è¿™é‡Œäº‹å®ä¸Šè¿›è¡Œäº†å•æ­¥å±•å¼€ï¼Œè¿›ä¸€æ­¥å°±å¯ä»¥å°è¯•åˆ©ç”¨è¿­ä»£ç»“æ„æ„é€ ä¸ç­‰å¼é“¾ï¼Œå…·ä½“ç»†èŠ‚åˆ™åœ¨åç»­è¯æ˜ä¸­è¯´æ˜ï¼š</p>
<p><span class="math display">$$
\begin{aligned}
V^\pi(s) &amp;\leq Q^\pi(s, \pi'(s)) \\
&amp;= \sum_{s' \in \S} \Pe(s' \mid s, \pi'(s))[r(s, \pi'(s), s') +
\gamma V^\pi(s')] \\
&amp;= \sum_{s' \in \S} \Pe(s' \mid s, \pi'(s))r(s, \pi'(s), s') +
\gamma\sum_{s' \in \S} \Pe(s' \mid s, \pi'(s)) V^\pi(s') \\
\end{aligned}
$$</span></p>
<p>å¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥è¯æ˜ï¼š</p>
<p><span class="math display">$$
\begin{aligned}
&amp;\sum_{s' \in \S} \Pe(s' \mid s, \pi'(s))r(s, \pi'(s), s') \\
=&amp; \sum_{s' \in \S} \Pe(s' \mid s, \pi'(s))\Eop_{\tau \sim \pi'}[r_1
\mid s_0 = s, a_0 = \pi'(s), s_1 = s'] \\
=&amp; \sum_{a \in \A} \pi'(a \mid s)\sum_{s' \in \S} \Pe(s' \mid s,
a)\Eop_{\tau \sim \pi'}[r_1 \mid s_0 = s, a_0 = a, s_1 = s'] \\
=&amp; \Eop_{\tau \sim \pi'}[r_1 \mid s_0 = s]
\end{aligned}
$$</span></p>
<p>å³å¾—åˆ°ï¼š</p>
<p><span class="math display">$$
V^\pi(s) \leq \Eop_{\tau \sim \pi'}[r_1 \mid s_0 = s] + \gamma\sum_{s'
\in \S} \Pe(s' \mid s, \pi'(s)) V^\pi(s')
$$</span></p>
<p>å¯¹è¿™ä¸ªä¸ç­‰å¼è¿­ä»£å±•å¼€ï¼š</p>
<p><span class="math display">$$
\begin{aligned}
V^\pi(s) &amp;\leq \Eop_{\tau \sim \pi'}[r_1 \mid s_0 = s] +
\gamma\sum_{s' \in \S} \Pe(s' \mid s, \pi'(s)) V^\pi(s') \\
&amp;\leq \Eop_{\tau \sim \pi'}[r_1 \mid s_0 = s] + \gamma\sum_{s' \in
\S} \Pe(s' \mid s, \pi'(s)) \left[\Eop_{\tau \sim \pi'}[r_2 \mid s_1 =
s'] + \gamma\sum_{s'' \in \S} \Pe(s'' \mid s', \pi'(s'))
V^\pi(s'')\right] \\
&amp;= \Eop_{\tau \sim \pi'}[r_1 \mid s_0 = s] + \gamma{\color{red}
\sum_{s' \in \S} \Pe(s' \mid s, \pi'(s))\Eop_{\tau \sim \pi'}[r_2 \mid
s_1 = s']} + \gamma^2\sum_{s' \in \S}\sum_{s'' \in \S}\Pe(s'' \mid s',
\pi'(s')) V^\pi(s'') \\
\end{aligned}
$$</span></p>
<p>å¯¹äºçº¢è‰²éƒ¨åˆ†ï¼Œæˆ‘ä»¬å®¹æ˜“å‘ç° <span
class="math inline"><em>s</em><sub>0</sub>â€„=â€„<em>s</em></span> å¯¹äº
<span class="math inline"><em>r</em><sub>2</sub></span>
çš„æœŸæœ›æ˜¯æ— æ•ˆæ¡ä»¶ï¼Œæ‰€ä»¥ï¼š</p>
<p><span class="math display">$$
\sum_{s' \in \S} \Pe(s' \mid s, \pi'(s))\Eop_{\tau \sim \pi'}[r_2 \mid
s_1 = s'] = \sum_{s' \in \S} \Pe(s' \mid s, \pi'(s))\Eop_{\tau \sim
\pi'}[r_2 \mid s_0 = s, s_1 = s'] = \Eop_{\tau \sim \pi'}[r_2 \mid s_0 =
s]
$$</span></p>
<p>æ‰€ä»¥ï¼š</p>
<p><span class="math display">$$
V^\pi(s) \leq \Eop_{\tau \sim \pi'}[{\color{red} r_1 + \gamma r_2} \mid
s_0 = s] + {\color{green} \gamma^2\sum_{s' \in \S}\sum_{s'' \in
\S}\Pe(s'' \mid s', \pi'(s')) V^\pi(s'')}
$$</span></p>
<p>æˆ‘ä»¬æ¥ä¸‹æ¥å±•å¼€ç»¿è‰²éƒ¨åˆ†çš„æ—¶å€™ï¼Œå¯ä»¥æ³¨æ„åˆ°æˆ‘ä»¬éœ€è¦ä¸º <span
class="math inline"><em>r</em><sub>3</sub></span> çš„æ¡ä»¶æœŸæœ›è¡¥ä¸Š <span
class="math inline"><em>s</em><sub>0</sub>â€„=â€„<em>s</em></span> å’Œ <span
class="math inline"><em>s</em><sub>1</sub>â€„=â€„<em>s</em>â€²</span>
ä¸¤ä¸ªæ— æ•ˆæ¡ä»¶ï¼Œç„¶åä¸¤ä¸ªæ±‚å’Œå·é€šè¿‡å…¨æœŸæœ›å…¬å¼æ¶ˆå» <span
class="math inline"><em>s</em><sub>1</sub>â€„=â€„<em>s</em>â€²</span> ä»¥åŠ
<span class="math inline"><em>s</em><sub>2</sub>â€„=â€„<em>s</em>â€³</span>
ä¸¤ä¸ªæ¡ä»¶ï¼Œæ•…å‰©ä½™çš„æ¡ä»¶ä»…æœ‰ <span
class="math inline"><em>s</em><sub>0</sub>â€„=â€„<em>s</em></span>ï¼Œä»è€Œå¯ä»¥è¿›ä¸€æ­¥åˆå¹¶åˆ°çº¢è‰²éƒ¨åˆ†ã€‚ä»¥æ­¤ç±»æ¨ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿè¯´æ˜è¯¥ä¸ç­‰å¼çš„è¿­ä»£å±•å¼€æ˜¯å¯è¡Œçš„ï¼Œä»è€Œå¾—åˆ°ï¼š</p>
<p><span class="math display">$$
V^\pi(s) \leq \Eop_{\tau \sim \pi'}[{\color{red} r_1 + \gamma r_2 +
\gamma^2r_3 + \cdots} \mid s_0 = s] = V^{\pi'}(s)
$$</span></p>
<p>ä»è€Œæ¬²è¯æ˜çš„ä¸ç­‰å¼æˆç«‹ã€‚</p>
<p>è€Œæ ¹æ®è¯æ˜è¿‡ç¨‹ï¼Œè¯¥ä¸ç­‰å¼å–ç­‰å½“ä¸”ä»…å½“æ»¡è¶³ <span
class="math inline">$V^\pi(s) = Q^\pi(s, \pi'(s)) = \max_{a \in
\A}Q^\pi(s, a)$</span>ï¼Œè€Œè¿™æ­£æ˜¯æœ€ä¼˜ Bellman æ–¹ç¨‹ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä½¿å¾—
<span
class="math inline"><em>V</em><sup><em>Ï€</em></sup>â€„=â€„<em>V</em><sup>â‹†</sup></span>ã€‚æ­¤å¤–ï¼Œ<span
class="math inline"><em>Ï€</em></span>
ç›®å‰ä¹Ÿå¿…é¡»æ˜¯ä¸€ä¸ªç¡®å®šæ€§ç­–ç•¥ï¼Œä»è€Œä¹Ÿå°±ä¿è¯äº† <span
class="math inline"><em>Ï€</em>â€„=â€„<em>Ï€</em><sup>â‹†</sup></span>ã€‚</p>
<p>ç»¼åˆç­–ç•¥è¯„ä¼°å’Œç­–ç•¥æå‡ï¼Œäº¤æ›¿è¿›è¡Œä¸¤è€…æˆ‘ä»¬å°±å¯ä»¥ä¿è¯èƒ½å¤Ÿè·å–åˆ°æœ€ä¼˜ç­–ç•¥ã€‚ç„¶è€Œè¿™ä¸ªæ–¹æ³•å¹¶ä¸ç°å®ï¼Œå› ä¸ºç†è®ºä¸Šæˆ‘ä»¬éœ€è¦å¯¹ç¯å¢ƒæœ‰å®Œå…¨æŠŠæ¡ï¼Œè‡³å°‘æˆ‘ä»¬éœ€è¦å¾—åˆ°æ•´ä¸ªç¯å¢ƒçŠ¶æ€è½¬ç§»çŸ©é˜µæ‰èƒ½è¿›è¡Œã€‚</p>
<h2 id="value-iteration-vi">Value Iteration (VI)</h2>
<p>åŒæ ·ï¼Œåœ¨å·²ç»å®Œå…¨å¾—çŸ¥ç¯å¢ƒçš„æ¡ä»¶ä¸‹ï¼Œé™¤äº†ç­–ç•¥è¿­ä»£ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨å€¼è¿­ä»£æ±‚è§£æœ€ä¼˜ç­–ç•¥ã€‚ç›¸è¾ƒäºç­–ç•¥è¿­ä»£æ˜¯è¿­ä»£ç­–ç•¥æœ¬èº«ï¼Œå€¼è¿­ä»£åˆ™æ˜¯åœ¨è¿­ä»£æ±‚è§£çŠ¶æ€ä»·å€¼å‡½æ•°ã€‚</p>
<p>è€ƒè™‘æœ€ä¼˜ Bellman æ–¹ç¨‹ï¼š</p>
<p><span class="math display">$$
{\color{red} V^\star(s)} = \max_{a \in \A} \left[\sum_{s' \in \S} \Pe(s'
\mid s, a)[r(s, a, s') + \gamma {\color{red} V^\star(s')}]\right]
$$</span></p>
<p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å®Œå…¨å¯ä»¥ç›´æ¥å…ˆéšæ„åˆå§‹åŒ–ä¸€ä¸ª <span
class="math inline"><em>V</em><sub>0</sub>â€„â‰¡â€„0</span>ï¼Œç„¶åä¸æ–­ä½¿ç”¨ä¸Šè¿°æ–¹ç¨‹åšè¿­ä»£ç›´åˆ°æ”¶æ•›ï¼Œæ­¤æ—¶
<span
class="math inline"><em>V</em><sub>+âˆ</sub>â€„=â€„<em>V</em><sup>â‹†</sup></span>ã€‚è¿­ä»£çš„æµç¨‹æè¿°ä¸ºï¼š</p>
<p><span class="math display">$$
{\color{red} V_{k + 1}(s)} \leftarrow \max_{a \in \A} \left[\sum_{s' \in
\S} \Pe(s' \mid s, a)[r(s, a, s') + \gamma {\color{red} V_k(s')}]\right]
$$</span></p>
<p>é‡å¤è¯¥è¿­ä»£ç›´åˆ°æ”¶æ•›ï¼Œå³å¯è·å¾—æœ€ä¼˜çŠ¶æ€ä»·å€¼å‡½æ•°ã€‚åŸºäºæœ€ä¼˜çŠ¶æ€ä»·å€¼å‡½æ•°ï¼Œå¯ä»¥æ¨çŸ¥æœ€ä¼˜ç­–ç•¥ï¼Œä»è€Œç®—æ³•æ±‚è§£å®Œæ¯•ã€‚</p>
<p>è¿™é‡Œéœ€è¦è¯´æ˜çš„ä¸€ç‚¹æ˜¯ï¼Œä½¿ç”¨å€¼è¿­ä»£æ±‚è§£çš„æ—¶å€™ï¼Œç­–ç•¥æ˜¯æ¯”ä»·å€¼å‡½æ•°å…ˆæ”¶æ•›çš„ã€‚è¿™ä¸€ç‚¹æ˜¯æ˜¾ç„¶çš„ï¼Œå› ä¸ºé€šè¿‡ä»·å€¼å‡½æ•°è·å–å¯¹åº”çš„ç­–ç•¥æ˜¯è´ªå¿ƒçš„ã€‚ä»è€Œï¼Œåœ¨ä»·å€¼å‡½æ•°è¿˜æœªå®é™…å®Œå…¨æ”¶æ•›çš„æ—¶å€™ï¼Œå„ä¸ªçŠ¶æ€çš„ä»·å€¼å¤§å°å…³ç³»å¾ˆæœ‰å¯èƒ½å·²ç»ç¡®å®šä¸”ä¸å˜åŒ–ï¼Œä»è€Œä»è¿™ä¸€æ—¶é—´ç‚¹å¼€å§‹ï¼Œæ¨çŸ¥çš„ç­–ç•¥éƒ½ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œç†è®ºä¸Šéƒ½æ˜¯æœ€ä¼˜ç­–ç•¥ã€‚</p>
<p>å€¼è¿­ä»£çš„æ—¶é—´å¤æ‚åº¦ä¸º <span
class="math inline">$O(|\S|^2|\A|)$</span>ã€‚</p>
<h2 id="æœ‰å…³-pi-å’Œ-vi-çš„ä¸€äº›å¯¹æ¯”">æœ‰å…³ PI å’Œ VI çš„ä¸€äº›å¯¹æ¯”</h2>
<p>äº‹å®ä¸ŠåŸºäº Bellman æ–¹ç¨‹è€Œè¨€ï¼ŒVI
æ–¹æ³•æ˜¯æœ€ç›´è§‚ä¹Ÿæ˜¯æœ€å®¹æ˜“æƒ³åˆ°çš„ï¼Œå› ä¸ºé€šè¿‡è¿­ä»£æ³•æ±‚è§£æœ‰é€’å½’ç»“æ„çš„æ–¹ç¨‹ç¡®å®æ˜¯ä¸€ç§å¾ˆå¸¸è§çš„æ–¹æ³•ã€‚ç„¶è€Œ
VI
çš„ä¸¤ä¸ªç‰¹ç‚¹ä¹Ÿæ˜¯é™åˆ¶å…¶è¿ç”¨çš„ç¼ºé™·ï¼Œå³<strong>ç­–ç•¥æ—©äºä»·å€¼å‡½æ•°æ”¶æ•›</strong>å’Œ<strong>å¤æ‚åº¦è¾ƒé«˜</strong>ã€‚</p>
<p>å‰è€…äº‹å®ä¸Šæ˜¯ VI
çš„ä¸€ä¸ªè‡´å‘½ç¼ºé™·ï¼Œå› ä¸ºä»æ ¹æœ¬ä¸Šè€Œè¨€æˆ‘ä»¬éœ€è¦è·å–çš„æ˜¯æœ€ä¼˜ç­–ç•¥ï¼Œå…·ä½“çš„ä»·å€¼å‡½æ•°å¯èƒ½å¹¶ä¸å…³æ³¨ï¼Œæˆ–è€…è‡³å°‘ä¸æ˜¯æœ€ä¸»è¦ç›®æ ‡ã€‚å¦å¤–ï¼Œé«˜å¤æ‚åº¦ä¹Ÿè®©
VI çš„å®é™…è¿ç®—éš¾åº¦è¾ƒé«˜ï¼Œè€Œè¿™ä¹Ÿä¸€å®šç¨‹åº¦ä¸Šå‚¬ç”Ÿäº† PI æ–¹æ³•ã€‚</p>
<p>VI åœ¨è¿ç®—è¿‡ç¨‹ä¸­æœ‰ä¸€æ­¥æ¶‰åŠåˆ°äº† <span class="math inline">$\max_{a \in
\A}$</span>ï¼Œè¿™éœ€è¦éå†è¡Œä¸ºç©ºé—´å´æ²¡æœ‰æœ‰æ•ˆåˆ©ç”¨éå†çš„ä¿¡æ¯ï¼ˆä»…å–äº†æœ€å¤§å€¼ï¼‰ã€‚é‚£ä¹ˆä¸€ä¸ªæ˜¾ç„¶çš„æ€§èƒ½æ¢æ—¶é—´çš„æ“ä½œå°±æ˜¯æˆ‘ä»¬å–ä¸€ä¸ªå¹¶éæœ€ä¼˜ä½†è¶³å¤Ÿä¼˜çš„ç­–ç•¥
<span class="math inline">$\pi: \S \to \A$</span>ï¼Œç›´æ¥ç”¨ <span
class="math inline"><em>a</em>â€„:=â€„<em>Ï€</em>(<em>s</em>)</span> ä»£æ›¿æ‰
<span class="math inline">$a := \argmax_{a \in
\A}$</span>ï¼Œè¿™æ ·å¤æ‚åº¦ç›´æ¥å°±é™ä½åˆ° <span
class="math inline">$O(|\S|^2)$</span>ã€‚</p>
<p>ä¸ºäº†ä¿è¯ <span class="math inline"><em>Ï€</em></span>
èƒ½å¤Ÿè¶³å¤Ÿä¼˜ï¼Œé‚£æˆ‘ä»¬å¯ä»¥ä¸¤è·¯å¹¶è¿›ï¼Œä¸€è·¯ä¼˜åŒ– <span
class="math inline"><em>Ï€</em></span>ï¼Œä¸€è·¯æ›´æ–° <span
class="math inline"><em>V</em><sup><em>Ï€</em></sup></span>ï¼Œä»è€Œæˆ‘ä»¬å°±å¾—åˆ°äº†
PI æ–¹æ³•ã€‚PI æ–¹æ³•åœ¨éƒ¨åˆ†æ¡ä»¶ä¸‹ä¼šæ¯” VI æ–¹æ³•æ”¶æ•›å¿«å¾ˆå¤šï¼Œå¹¶ä¸”æˆ‘ä»¬ä¾ç„¶å¯ä»¥è¯æ˜
PI ç†è®ºå¯ä»¥å¾—åˆ°æœ€ä¼˜ç­–ç•¥ã€‚</p>
<h2 id="æœ‰å…³-bellman-ç®—å­çš„æ‹“å±•">æœ‰å…³ Bellman ç®—å­çš„æ‹“å±•</h2>
<p>å¦‚æœä»”ç»†è§‚å¯Ÿ Bellman æ–¹ç¨‹ï¼Œå…¶äº‹å®ä¸Šå°±æ˜¯ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹ï¼š</p>
<p><span class="math display">$$
{\color{red} V^\pi(s)} = \sum_{a \in \A} \pi(a \mid s) \sum_{s' \in \S}
\Pe(s' \mid s, a)[r(s, a, s') + \gamma {\color{red} V^\pi(s')}]
$$</span></p>
<p>é¦–å…ˆä½œä¸€äº›è®°å·ç®€åŒ–ï¼š</p>
<p><span class="math display">$$
\begin{aligned}
\P^\pi(s' \mid s) &amp;:= \sum_{a \in \A} \pi(a \mid s)\Pe(s' \mid s, a)
\\
r^\pi(s) &amp;:= \sum_{a \in \A} \pi(a \mid s) \sum_{s' \in \S} \Pe(s'
\mid s, a)r(s, a, s') \\
\end{aligned}
$$</span></p>
<p>å¾—åˆ°ï¼š</p>
<p><span class="math display">$$
{\color{red} V^\pi(s)} = r^\pi(s) + \gamma\sum_{s' \in \S} \P^\pi(s'
\mid s){\color{red} V^\pi(s')}
$$</span></p>
<p>å¦‚æœè®° <span class="math inline">$\S = \{s_1, s_2, \cdots, s_n\}, n =
|\S|$</span>ï¼Œå¹¶å®šä¹‰çŸ©é˜µï¼š</p>
<p><span class="math display">$$
\begin{aligned}
\b{V}^\pi &amp;:= (v^\pi_i)^T_{n} \in \R^n &amp;&amp; v^\pi_i :=
V^\pi(s_i) \\
\b{R}^\pi &amp;:= (r^\pi_i)^T_{n} \in \R^n &amp;&amp; r^\pi_i :=
r^\pi(s_i) \\
\b{P}^\pi &amp;:= (p^\pi_{ij})_{n \times n} \in \R^{n \times n}
&amp;&amp; p^\pi_{ij} := \P^\pi(s_j \mid s_i) \\
\end{aligned}
$$</span></p>
<p>é‚£ä¹ˆ Bellman æ–¹ç¨‹ç­‰ä»·äºï¼š</p>
<p><span class="math display">$$
\b{V}^\pi = \b{R}^\pi + \gamma\b{P}^\pi\b{V}^\pi \Rightarrow (I -
\gamma\b{P}^\pi)\b{V}^\pi = \b{R}^\pi
$$</span></p>
<p>è¿™é‡Œå°±å¯ä»¥å¼•å…¥ Bellman ç®—å­ï¼š</p>
<p><span class="math display">$$
\mathcal{T}^\pi(\b{x}) := \b{R}^\pi + \gamma\b{P}^\pi\b{x}
$$</span></p>
<p>å¦‚æœçŠ¶æ€ç©ºé—´è¶³å¤Ÿå°ï¼Œé‚£ä¹ˆåœ¨ PI
çš„ç­–ç•¥è¯„ä¼°é˜¶æ®µï¼Œäº‹å®ä¸Šå®Œå…¨å¯ä»¥é€šè¿‡æ±‚è§£ä¸Šè¿°çº¿æ€§æ–¹ç¨‹ç»„è§£çš„æ–¹å¼å¾—åˆ°ç­–ç•¥çš„ä»·å€¼å‡½æ•°ã€‚</p>
<p>é™¤äº† Bellman ç®—å­ï¼Œè¿˜å¯ä»¥ä»æœ€ä¼˜ Bellman æ–¹ç¨‹å¼•å…¥æœ€ä¼˜ Bellman
ç®—å­ã€‚é¦–å…ˆä¾ç„¶æ˜¯å®šä¹‰çŸ©é˜µï¼š</p>
<p><span class="math display">$$
\begin{aligned}
\b{V}^\star &amp;:= (v^\star_i)^T_{n} \in \R^n &amp;&amp; v^\star_i :=
V^\star(s_i) \\
\b{R}(a) &amp;:= (r_i(a))^T_{n} \in \R^n &amp;&amp; r_i(a) := \sum_{s_j
\in \S} \Pe(s_j \mid s_i, a)r(s_i, a, s_j) \\
\b{P}(a) &amp;:= (p_{ij}(a))_{n \times n} \in \R^{n \times n} &amp;&amp;
p_{ij}(a) := \Pe(s_j \mid s_i, a) \\
\end{aligned}
$$</span></p>
<p>é‚£ä¹ˆæœ€ä¼˜ Bellman ç®—å­å°±å®šä¹‰ä¸ºï¼š</p>
<p><span class="math display">$$
\mathcal{T}^\star(\b{x}) := \max_{a \in \A}(\b{R}(a) +
\gamma\b{P}(a)\b{x})
$$</span></p>
<p>ç°åœ¨æˆ‘ä»¬éœ€è¦è¯æ˜ä¸€ä¸ªæˆ‘ä»¬å¹¶æ²¡æœ‰ä¸¥æ ¼è¯´æ˜çš„å¼•ç†ï¼Œå³ä½¿ç”¨è¿­ä»£æ³•æ±‚è§£ä»·å€¼å‡½æ•°çš„åˆæ³•æ€§ï¼Œæ— è®ºæ˜¯
PI ä¸­ç­–ç•¥è¯„ä¼°è¿˜æ˜¯ VI
æ±‚æœ€ä¼˜ä»·å€¼å‡½æ•°æœ¬èº«ã€‚äº‹å®ä¸Šï¼Œè¿™ä¸¤è€…æœ¬è´¨ç›¸åŒï¼Œå…¶éƒ½åœ¨æ±‚è§£ Bellman
ç®—å­çš„ä¸åŠ¨ç‚¹ï¼Œåªä¸è¿‡ä¸€ä¸ªæ˜¯ä¸€èˆ¬ Bellman ç®—å­ï¼Œä¸€ä¸ªæ˜¯æœ€ä¼˜ Bellman
ç®—å­ã€‚è¿™é‡Œä»¥æœ€ä¼˜ Bellman ç®—å­ä¸ºä¾‹è¿›è¡Œè¯æ˜ã€‚</p>
<p>è¯æ˜çš„ä¸»è¦æ€æƒ³å°±æ˜¯ Banach ç©ºé—´ä¸åŠ¨ç‚¹å®šç†ã€‚</p>
<div class="note info no-icon"><p><strong>Theorem 2.02 (Banach Fixed-point Theorem)</strong>
ç»™å®šå®Œå¤‡åº¦é‡ç©ºé—´ <span class="math inline"><em>X</em></span> ä»¥åŠå…¶èŒƒæ•°
<span class="math inline"><em>d</em></span>ï¼Œå‡è®¾ <span
class="math inline"><em>f</em>â€„:â€„<em>X</em>â€„â†’â€„<em>X</em></span>
æ˜¯ä¸€ä¸ªå‹ç¼©æ˜ å°„ï¼Œå³å­˜åœ¨ <span
class="math inline"><em>Î³</em>â€„âˆˆâ€„[0,â€†1)</span> ä»¤ <span
class="math inline">âˆ€<em>x</em><sub>1</sub>,â€†<em>x</em><sub>2</sub>â€„âˆˆâ€„<em>X</em></span>
éƒ½æœ‰ï¼š</p>
<p><span
class="math display"><em>d</em>(<em>f</em>(<em>x</em><sub>1</sub>),<em>f</em>(<em>x</em><sub>2</sub>))â€„â‰¤â€„<em>Î³</em><em>d</em>(<em>x</em><sub>1</sub>,<em>x</em><sub>2</sub>)</span></p>
<p>é‚£ä¹ˆ <span class="math inline"><em>f</em></span> åœ¨ <span
class="math inline"><em>X</em></span> ä¸Šå­˜åœ¨å”¯ä¸€ä¸åŠ¨ç‚¹ <span
class="math inline"><em>x</em><sup>*</sup></span>ã€‚</p>
<p>è¯¥ä¸åŠ¨ç‚¹æ»¡è¶³ï¼Œä»»å– <span
class="math inline"><em>x</em><sub>0</sub>â€„âˆˆâ€„<em>X</em></span>ï¼Œå®šä¹‰åºåˆ—
<span
class="math inline">{<em>x</em><sub><em>n</em></sub>}<sub><em>n</em>â€„â‰¥â€„0</sub></span>ï¼Œå…¶ä¸­
<span
class="math inline"><em>x</em><sub><em>n</em>â€…+â€…1</sub>â€„=â€„<em>f</em>(<em>x</em><sub><em>n</em></sub>),â€†<em>n</em>â€„â‰¥â€„0</span>ï¼Œé‚£ä¹ˆè¯¥åºåˆ—å¿…ç„¶æ”¶æ•›åˆ°
<span class="math inline"><em>x</em><sup>*</sup></span>ã€‚</p>
</div>
<p>è¯æ˜æ˜¯ç®€å•çš„ã€‚é¦–å…ˆæˆ‘ä»¬ä»»å– <span
class="math inline"><em>x</em><sub>0</sub>â€„âˆˆâ€„<em>X</em></span>ï¼Œè€ƒè™‘å¯¹
<span class="math inline"><em>m</em>â€„&gt;â€„<em>n</em></span>ï¼š</p>
<p><span class="math display">$$
\begin{aligned}
d(f^{(m)}(x_0), f^{(n)}(x_0)) &amp;\leq d(f^{(m)}(x_0), f^{(m -
1)}(x_0)) + d(f^{(m - 1)}(x_0), f^{(m - 2)}(x_0)) + \cdots + d(f^{(n +
1)}(x_0), f^{(n)}(x_0)) \\
&amp;\leq \gamma^{m - 1}d(f(x_0), x_0) + \gamma^{m - 2}d(f(x_0), x_0) +
\cdots + \gamma^nd(f(x_0), x_0) \\
&amp;\leq \dfrac{\gamma^n}{1 - \gamma}d(f(x_0), x_0) \\
\end{aligned}
$$</span></p>
<p>ä¹Ÿå°±æ˜¯æ— è®ºç»™å¤šç´§çš„ç•Œï¼Œæˆ‘æ€»èƒ½ä»¤ <span
class="math inline"><em>n</em></span> å……åˆ†å¤§æ»¡è¶³ä¸Šç•Œçº¦æŸï¼Œä»è€Œè¯¥åºåˆ—æ˜¯
Cauchy åºåˆ—ï¼Œåœ¨å®Œå¤‡åº¦é‡ç©ºé—´ä¸Šå…¶è‡ªç„¶æ˜¯æ”¶æ•›çš„ã€‚</p>
<p>å‡å®šè¿™ä¸ªåºåˆ—æ”¶æ•›åˆ° <span
class="math inline"><em>x</em><sup>*</sup></span>ï¼Œæˆ‘ä»¬éœ€è¦è¯´æ˜ <span
class="math inline"><em>x</em><sup>*</sup></span> æ˜¯ <span
class="math inline"><em>f</em></span>
çš„ä¸åŠ¨ç‚¹ä»¥åŠå…¶å”¯ä¸€æ€§ã€‚å…¶æ˜¯ä¸åŠ¨ç‚¹æ˜¯å®¹æ˜“çš„ï¼Œè€ƒè™‘ï¼š</p>
<p><span
class="math display">0â€„â‰¤â€„<em>d</em>(<em>x</em><sub><em>n</em>â€…+â€…1</sub>,<em>f</em>(<em>x</em><sup>*</sup>))â€„=â€„<em>d</em>(<em>f</em>(<em>x</em><sub><em>n</em></sub>),<em>f</em>(<em>x</em><sup>*</sup>))â€„â‰¤â€„<em>Î³</em><em>d</em>(<em>x</em><sub><em>n</em></sub>,<em>x</em><sup>*</sup>)</span></p>
<p>ç”±äº <span class="math inline"><em>n</em>â€„â†’â€„âˆ</span> æ—¶ <span
class="math inline"><em>d</em>(<em>x</em><sub><em>n</em></sub>,<em>x</em><sup>*</sup>)â€„â†’â€„0</span>ï¼Œè¿™è¯´æ˜
<span
class="math inline"><em>d</em>(<em>x</em><sub><em>n</em>â€…+â€…1</sub>,<em>f</em>(<em>x</em><sup>*</sup>))â€„â†’â€„0</span>ï¼Œä¹Ÿå°±è¯´æ˜
<span class="math inline"><em>f</em>(<em>x</em><sup>*</sup>)</span>
ä¹Ÿæ˜¯åºåˆ— <span
class="math inline">{<em>x</em><sub><em>n</em></sub>}<sub><em>n</em>â€„â‰¥â€„0</sub></span>
çš„æé™ï¼Œæ®æé™çš„å”¯ä¸€æ€§ï¼Œä¸åŠ¨ç‚¹å¾—è¯ã€‚</p>
<p>å”¯ä¸€æ€§åˆ™æ®åè¯ã€‚è‹¥å­˜åœ¨ç¬¬äºŒä¸ªä¸åŠ¨ç‚¹ <span
class="math inline"><em>f</em>(<em>y</em>)â€„=â€„<em>y</em></span>ï¼Œé‚£ä¹ˆï¼š</p>
<p><span
class="math display"><em>d</em>(<em>x</em><sup>*</sup>,<em>y</em>)â€„=â€„<em>d</em>(<em>f</em>(<em>x</em><sup>*</sup>),<em>f</em>(<em>y</em>))â€„â‰¤â€„<em>Î³</em><em>d</em>(<em>x</em><sup>*</sup>,<em>y</em>)â€„â‡’â€„(1âˆ’<em>Î³</em>)<em>d</em>(<em>x</em><sup>*</sup>,<em>y</em>)â€„â‰¤â€„0</span></p>
<p>ä¸Šè¿°çº¦æŸä»…æœ‰ <span
class="math inline"><em>y</em>â€„=â€„<em>x</em><sup>*</sup></span>
æ—¶æˆç«‹ï¼Œå”¯ä¸€æ€§å¾—è¯ã€‚</p>
<hr />
<p>åŸºäºè¯¥å¼•ç†ï¼Œæˆ‘ä»¬åªéœ€è¦è¯´æ˜æœ€ä¼˜ Bellman
ç®—å­ä¹Ÿæ»¡è¶³å¼•ç†æ‰€è¿°æ¡ä»¶å³å¯ã€‚åœ¨ç©ºé—´ <span class="math inline">$\S$</span>
ä¸Šå–å…¶ <span class="math inline"><em>L</em><sup>âˆ</sup></span>
èŒƒæ•°ï¼ˆå³å„åˆ†é‡æœ€å¤§å€¼ï¼‰ã€‚æˆ‘ä»¬è¯æ˜æœ€ä¼˜ Bellman ç®—å­æ˜¯å‹ç¼©çš„ï¼š</p>
<p><span class="math display">$$
\begin{aligned}
\|\mathcal{T}^\star(\b{V}_1) - \mathcal{T}^\star(\b{V}_2)\|_\infty
&amp;= \left\|\max_{a \in \A}(\b{R}(a) + \gamma\b{P}(a)\b{V}_1) -
\max_{a \in \A}(\b{R}(a) + \gamma\b{P}(a)\b{V}_2)\right\|_\infty \\
&amp;\leq \left\|\max_{a \in \A}(\b{R}(a) + \gamma\b{P}(a)\b{V}_1 -
\b{R}(a) - \gamma\b{P}(a)\b{V}_2)\right\|_\infty \\
&amp;= \gamma\left\|\max_{a \in \A}(\b{P}(a)(\b{V}_1 -
\b{V}_2))\right\|_\infty \\
&amp;\leq \gamma\|\b{V}_1 - \b{V}_2\|_\infty
\end{aligned}
$$</span></p>
<p>æœ€åä¸€ä¸ªä¸ç­‰å·æºäº <span class="math inline">$\b{P}(a)$</span>
çŸ©é˜µä¸­ï¼Œæ¯ä¸€è¡Œçš„å…ƒç´ ä¹‹å’Œå¿…ç„¶ä¸º <span
class="math inline">1</span>ã€‚å¦‚æœå‡è®¾ <span
class="math inline">$\b{V}_1 - \b{V}_2$</span> å„å…ƒç´ ä¸­æœ€å¤§ä¸º <span
class="math inline"><em>p</em></span>ï¼ˆäº¦å…¶ <span
class="math inline"><em>L</em><sup>âˆ</sup></span> èŒƒæ•°ï¼‰ï¼Œé‚£ä¹ˆ <span
class="math inline">$\b{P}(a)(\b{V}_1 - \b{V}_2)$</span>
æ¯ä¸€ä¸ªå…ƒç´ éƒ½ä¸ä¼šå¤§äº <span class="math inline"><em>p</em></span>ã€‚</p>
<p>ä»è€Œå¾—è¯ã€‚</p>
<p>äº‹å®ä¸Šæˆ‘ä»¬æœ‰ä¸‹è¿°å®šç†ï¼Œæè¿°äº†è¿­ä»£æ³•æ±‚è§£çš„æ­£ç¡®æ€§ã€‚å¯¹äºä»»æ„åˆå§‹åŒ–çš„
<span class="math inline">$\b{V}_0$</span>ï¼š</p>
<p><span class="math display">$$
\lim_{n \to \infty} \mathcal{T}^{\pi(n)}\b{V}_0 = \b{V}^\pi, \lim_{n \to
\infty} \mathcal{T}^{\star(n)}\b{V}_0 = \b{V}^\star
$$</span></p>
<h1 id="åŸºäºç¯å¢ƒäº¤äº’çš„-rl-æ–¹æ³•">åŸºäºç¯å¢ƒäº¤äº’çš„ RL æ–¹æ³•</h1>
<p>å¦‚æœæˆ‘ä»¬æ— æ³•æŒæ¡ç¯å¢ƒçš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å°±éœ€è¦ä»¤æ™ºèƒ½ä½“ä¸ç¯å¢ƒäº¤äº’ä»¥æ”¶é›†ä¿¡æ¯ã€‚è€Œè¿™ä¹Ÿæ˜¯å½“å‰ç»å¤§å¤šæ•°
RL é—®é¢˜éœ€è¦é‡‡ç”¨çš„æ–¹æ³•ï¼Œå› ä¸ºæˆ‘ä»¬å®Œå…¨èƒ½æŒæ¡çš„ç¯å¢ƒå‡ ä¹ä¸å­˜åœ¨ã€‚</p>
<p>è¿™é‡Œç®€å•æä¸€ä¸‹<strong>æ— æ¨¡å‹ï¼ˆModel-freeï¼‰</strong>ä¸<strong>åŸºäºæ¨¡å‹ï¼ˆModel-basedï¼‰</strong>çš„æ¦‚å¿µã€‚åœ¨æ™ºèƒ½ä½“å’Œç¯å¢ƒäº¤äº’çš„è¿‡ç¨‹ä¸­ï¼Œäº‹å®ä¸Šæˆ‘ä»¬æœ‰ä¸¤ç§é€‰æ‹©ï¼Œå…¶ä¸€æ˜¯è®©æ™ºèƒ½ä½“å»å’ŒçœŸå®çš„ç¯å¢ƒä½œäº¤äº’ï¼Œè¿™å°±æ˜¯æ— æ¨¡å‹æ–¹æ³•ã€‚å…¶äºŒæ˜¯æˆ‘ä»¬äº‹å…ˆä½¿ç”¨å¦å¤–ä¸€ä¸ªæ¨¡å‹å»æ‹Ÿåˆç¯å¢ƒï¼Œè®©æ™ºèƒ½ä½“å’Œè¿™ä¸ªæ¨¡å‹äº¤äº’ï¼Œè¿™å°±æ˜¯åŸºäºæ¨¡å‹æ–¹æ³•ã€‚åŸºäºæ¨¡å‹æ–¹æ³•çš„ä¼˜åŠ¿åœ¨äºï¼Œå¦‚æœæ™ºèƒ½ä½“å’ŒçœŸå®çš„ç¯å¢ƒäº¤äº’æˆæœ¬é«˜æ˜‚æˆ–è€…ç¯å¢ƒå“åº”è¾ƒæ…¢ï¼Œåˆ™å¯ä»¥ç”¨äºå¤§å¹…é™ä½å®éªŒæˆæœ¬ã€‚ä½†ç›¸åº”åœ°ï¼ŒåŸºäºæ¨¡å‹æ–¹æ³•ä¹Ÿéœ€è¦ä¸€ä¸ªç›¸å½“ä¼˜è¶Šçš„å’Œç¯å¢ƒå¥‘åˆçš„æ¨¡å‹æ‰èƒ½è®©æ™ºèƒ½ä½“çœŸæ­£å­¦ä¹ åˆ°æœ€ä¼˜ç­–ç•¥ã€‚</p>
<p>åŸºäºç¯å¢ƒäº¤äº’çš„ RL
æ–¹æ³•çš„æµç¨‹äº‹å®ä¸Šè¿‘ä¼¼äºç­–ç•¥è¿­ä»£ï¼Œä¹Ÿè¢«ç§°ä¸º<strong>å¹¿ä¹‰ç­–ç•¥è¿­ä»£ï¼ˆGeneral
Policy Iteration, GPIï¼‰</strong>ã€‚GPI
çš„æµç¨‹æ˜¯é¦–å…ˆåˆå§‹åŒ–ä¸€ä¸ªä»·å€¼å‡½æ•°å’Œç­–ç•¥ <span
class="math inline"><em>V</em>,â€†<em>Ï€</em></span>ï¼Œå¹¶ä¸æ–­é‡å¤ä¸‹è¿°ä¸¤ä¸ªæ“ä½œï¼š</p>
<ul>
<li>ï¼ˆç­–ç•¥è¯„ä¼°ï¼‰æ›´æ–°ä»·å€¼å‡½æ•°ä½¿å¾—å…¶ç¬¦åˆå½“å‰çš„ç­–ç•¥ï¼Œå³ <span
class="math inline"><em>V</em>â€„=â€„<em>V</em><sup><em>Ï€</em></sup></span></li>
<li>ï¼ˆç­–ç•¥æ”¹è¿›ï¼‰æ ¹æ®å½“å‰ä»·å€¼å‡½æ•°è´ªå¿ƒåœ°æ›´æ–°ç­–ç•¥ï¼Œå³ <span
class="math inline">$\pi = {\rm greedy}(V)$</span></li>
</ul>
<p>å½“ç„¶ï¼Œè¿™é‡Œæ˜¯ä»¥çŠ¶æ€ä»·å€¼å‡½æ•° <span
class="math inline"><em>V</em></span> ä½œä¸ºæ¯”æ–¹ï¼Œäº‹å®ä¸ŠçŠ¶æ€è¡Œä¸ºä»·å€¼å‡½æ•°
<span class="math inline"><em>Q</em></span> ä¹Ÿå¯ä»¥åº”ç”¨åˆ°ä¸Šè¿°æµç¨‹ä¸­ã€‚</p>
<p>å…·ä½“è®²è§£ä¹‹å‰ï¼Œé¦–å…ˆå¼•å…¥<strong>åŒè½¨ï¼ˆOn-policyï¼‰</strong>å’Œ<strong>å¼‚è½¨ï¼ˆOff-policyï¼‰</strong>çš„æ¦‚å¿µã€‚è¿™ç±»
RL
æ–¹æ³•ä¸­æ™ºèƒ½ä½“æ‰€æ‰§è¡Œçš„ç­–ç•¥ä¸€èˆ¬æœ‰ä¸¤ç§ç”¨é€”ï¼Œå…¶ä¸€æ˜¯ç”¨äºä¸ç¯å¢ƒäº¤äº’æ”¶é›†è½¬ç§»è½¨è¿¹ï¼Œè¿™ä¸ªç­–ç•¥ç§°ä¸º<strong>é‡‡æ ·ç­–ç•¥ï¼ˆSample
Policyï¼‰</strong>æˆ–è€…<strong>è¡Œä¸ºç­–ç•¥ï¼ˆBehavioral
Policyï¼‰</strong>ï¼Œå…¶äºŒæ˜¯ç”¨äºåœ¨ç¯å¢ƒä¸­è·å–æ”¶ç›Šï¼Œè¿™ä¸ªç­–ç•¥ç§°ä¸º<strong>ç›®æ ‡ç­–ç•¥ï¼ˆTarget
Policyï¼‰</strong>ã€‚å¦‚æœä¸€ä¸ªæ™ºèƒ½ä½“çš„è¡Œä¸ºç­–ç•¥å’Œç›®æ ‡ç­–ç•¥æ˜¯ä¸ä¸€è‡´çš„ï¼Œé‚£è¿™ä¸ªæ–¹æ³•å°±æ˜¯å¼‚è½¨çš„ï¼Œç›¸å¯¹åº”åœ°ï¼Œè¡Œä¸ºç­–ç•¥å’Œç›®æ ‡ç­–ç•¥ä¸€è‡´çš„æ—¶å€™è¿™ä¸ªæ–¹æ³•æ˜¯åŒè½¨çš„ã€‚</p>
<p>å¦‚æœé‡‡ç”¨åŒè½¨æ–¹æ³•ï¼Œé‚£ä¹ˆç­–ç•¥è¯„ä¼°ã€ç­–ç•¥æ”¹è¿›çš„æµç¨‹å°±æ˜¯ç®€å•çš„ï¼Œä¹Ÿå°±æ˜¯æŒ‰ç…§æè¿°è¿­ä»£å³å¯ã€‚ç„¶è€Œå¦‚æœé‡‡ç”¨å¼‚è½¨æ–¹æ³•ï¼Œé€šç”¨çš„æ–¹æ³•æ˜¯ï¼š</p>
<ul>
<li>ç­–ç•¥è¯„ä¼°æ—¶åº”å½“ä¼°ç®—<strong>ç›®æ ‡ç­–ç•¥</strong>çš„ä»·å€¼å‡½æ•°</li>
<li>ç­–ç•¥æ”¹è¿›æ—¶åº”å½“è´ªå¿ƒåœ°ç”Ÿæˆ<strong>è¡Œä¸ºç­–ç•¥</strong></li>
</ul>
<h2 id="ç­–ç•¥è¯„ä¼°">ç­–ç•¥è¯„ä¼°</h2>
<h3 id="monte-carlo-mc">Monte-Carlo (MC)</h3>
<p>MC
æ–¹æ³•è®¡ç®—ç›®æ ‡ç­–ç•¥çš„ä»·å€¼å‡½æ•°çš„æ–¹æ³•éå¸¸ç®€å•ï¼Œå³ä½¿ç”¨è¡Œä¸ºç­–ç•¥ç›´æ¥é‡‡æ ·ä¸€æ•´æ¡è½¨è¿¹ï¼Œåˆ©ç”¨è¿™ä¸€æ¡è½¨è¿¹ä¸Šçš„ä¿¡æ¯æ›´æ–°ä»·å€¼å‡½æ•°ã€‚æ›´æ–°æ–¹å¼ä¹Ÿç›¸å¯¹ç®€å•ï¼Œç›´æ¥ä½¿ç”¨ç®—æœ¯å¹³å‡å€¼æˆ–è€…åˆ©ç”¨å­¦ä¹ ç‡æ›´æ–°å³å¯ã€‚è®¾å®šå›ºå®šçš„å­¦ä¹ ç‡
<span class="math inline"><em>Î±</em></span>ï¼Œè‹¥è¡Œä¸ºç­–ç•¥é‡‡æ ·å¾—åˆ°çš„è½¨è¿¹ä¸º
<span class="math inline"><em>Ï„</em></span>ï¼Œå¯¹è¯¥è½¨è¿¹ä¸Šä»»ä½•ä¸€ä¸ªçŠ¶æ€
<span class="math inline"><em>s</em><sub><em>t</em></sub></span>ï¼ŒMC
æ–¹æ³•çš„æ›´æ–°å…¬å¼ä¸ºï¼š</p>
<p><span
class="math display"><em>V</em>(<em>s</em><sub><em>t</em></sub>)â€„â†â€„<em>V</em>(<em>s</em><sub><em>t</em></sub>)â€…+â€…<em>Î±</em>(<em>G</em><sub><em>t</em></sub>(<em>Ï„</em>)âˆ’<em>V</em>(<em>s</em><sub><em>t</em></sub>))</span></p>
<p>ç†è®ºè€Œè¨€ï¼ŒMC æ–¹æ³•ç›¸å½“ç®€æ˜“ä¸”ä¸æ¶‰åŠåˆ° bootstrapã€‚è¿™é‡Œ bootstrap
æŒ‡çš„æ˜¯ä¸€ç±»â€œåˆ©ç”¨ä¼°è®¡å€¼æœ¬èº«æ›´æ–°ä¼°è®¡å€¼â€çš„æ›´æ–°ç­–ç•¥ï¼Œåœ¨åç»­ TD
æ–¹æ³•ä¸­å±•å¼€è¯´æ˜ã€‚å¦ä¸€æ–¹é¢ï¼ŒMC æ–¹æ³•ä¹Ÿå› ä¸ºä½æ•ˆå’Œå¹¶æ²¡æœ‰å……åˆ†åˆ©ç”¨ Bellman
æ–¹ç¨‹è€Œå…·æœ‰ç¼ºé™·ã€‚</p>
<div class="note info no-icon"><p>GPI ä¸­ä½¿ç”¨ MC æ–¹æ³•åšç­–ç•¥è¯„ä¼°çš„ç®—æ³•ä¸€èˆ¬ç§°ä¸º
<strong>è’™ç‰¹å¡æ´›æ§åˆ¶ç®—æ³•</strong>ã€‚</p>
</div>
<h3 id="temporal-difference-td">Temporal-Difference (TD)</h3>
<p>TD æ–¹æ³•ä¸ MC
æ–¹æ³•ç›®æ ‡æ˜¯ä¸€è‡´çš„ï¼Œä¹Ÿæ˜¯å°½åŠ›å–å¾—ä»·å€¼å‡½æ•°çš„å‡†ç¡®ä¼°è®¡ã€‚ä½†æ˜¯ä¸¤è€…çš„æ ¸å¿ƒå·®åˆ«åœ¨äºï¼ŒTD
æ–¹æ³•æ˜¯ä¸€ä¸ªæ›´æ–°åŠ›åº¦æ›´å°çš„ bootstrap æ–¹æ³•ï¼ŒTD
æ–¹æ³•ä¼šåœ¨æ¯ä¸€æ¬¡å†³ç­–åè¿›è¡Œæ›´æ–°ã€‚è¿™ç§é€æ­¥æ›´æ–°çš„é—®é¢˜åœ¨äºæˆ‘ä»¬æ— æ³•ç²¾ç¡®è·å–æŸä¸€ä¸ªçŠ¶æ€çš„ç´¯è®¡æ”¶ç›Šï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è™šåŒ–ä¸€ä¸ªæ›´æ–°ç›®æ ‡ï¼Œè¿™ä¹Ÿå°±æ˜¯æ‰€è°“çš„
TD targetã€‚</p>
<p>å‡è®¾æˆ‘ä»¬åœ¨æ—¶åˆ» <span class="math inline"><em>t</em></span> æ—¶ä½äºçŠ¶æ€
<span
class="math inline"><em>s</em><sub><em>t</em></sub></span>ï¼Œæˆ‘ä»¬é€šè¿‡å†³ç­–è¡Œä¸º
<span class="math inline"><em>a</em><sub><em>t</em></sub></span>
è¿ç§»åˆ°äº†çŠ¶æ€ <span
class="math inline"><em>s</em><sub><em>t</em>â€…+â€…1</sub></span>ï¼Œå¹¶ä¸”è·å–æ”¶ç›Š
<span
class="math inline"><em>r</em><sub><em>t</em>â€…+â€…1</sub></span>ã€‚å¦å¤–ï¼Œæˆ‘ä»¬ä¿å­˜æœ‰ä¸€ä¸ªæ‰€æœ‰çŠ¶æ€çš„ä»·å€¼å‡½æ•°ä¼°è®¡å€¼è¡¨
<span class="math inline">$V(s), s \in \S$</span>ã€‚é‚£ä¹ˆ TD target
æŒ‡çš„æ˜¯ï¼š</p>
<p><span class="math display">$$
{\rm TD\ target} := r_{t + 1} + \gamma V(s_{t + 1})
$$</span></p>
<p>å¯ä»¥æ³¨æ„åˆ°ï¼ŒTD target æœ¬èº«æ˜¯åˆ©ç”¨ç±»ä¼¼ Bellman
æ–¹ç¨‹ä¸­çš„æ­¥è¿›å±•å¼€æ–¹æ³•ï¼Œé€šè¿‡ <span
class="math inline"><em>V</em>(<em>s</em><sub><em>t</em>â€…+â€…1</sub>)</span>
å¯¹ <span
class="math inline"><em>V</em>(<em>s</em><sub><em>t</em></sub>)</span>
ä½œå‡ºä¼°è®¡ï¼Œå¹¶ä»¥æ­¤ä½œä¸º <span
class="math inline"><em>V</em>(<em>s</em><sub><em>t</em></sub>)</span>
æ›´æ–°çš„ç›®æ ‡ã€‚è¿™å’Œ MC
ä½¿ç”¨çœŸå®é‡‡æ ·è·å–åˆ°çœŸå®çš„ç´¯è®¡æ”¶ç›Šä½œä¸ºæ›´æ–°ç›®æ ‡å®Œå…¨ä¸åŒï¼Œè¿™ä¹Ÿå°±æ˜¯ bootstrap
çš„å«ä¹‰ã€‚</p>
<p>åœ¨è·å– TD target åï¼Œå°±å¯ä»¥è®¡ç®—ç›®æ ‡å’Œå½“å‰ä¼°è®¡å€¼çš„å·®ï¼Œå³ TD
errorï¼š</p>
<p><span class="math display">$$
{\rm TD\ error} = \delta_t := r_{t + 1} + \gamma V(s_{t + 1}) - V(s_t)
$$</span></p>
<p>ä¹‹åï¼Œè®¾å®šä¸€ä¸ªé€‚å½“çš„å­¦ä¹ ç‡ <span
class="math inline"><em>Î±</em></span>ï¼Œå³å¯å¾—åˆ° TD
æ–¹æ³•çš„æ ¸å¿ƒæ›´æ–°ç­–ç•¥ï¼Œä¸‹è¿°è¿™ç§ç®€å•çš„æ›´æ–°ç­–ç•¥ä¹Ÿè¢«ç§°ä¸º TD(0) æ–¹æ³•ï¼š</p>
<p><span
class="math display"><em>V</em>(<em>s</em><sub><em>t</em></sub>)â€„â†â€„<em>V</em>(<em>s</em><sub><em>t</em></sub>)â€…+â€…<em>Î±</em><em>Î´</em><sub><em>t</em></sub>â€„=â€„<em>V</em>(<em>s</em><sub><em>t</em></sub>)â€…+â€…<em>Î±</em>(<em>r</em><sub><em>t</em>â€…+â€…1</sub>+<em>Î³</em><em>V</em>(<em>s</em><sub><em>t</em>â€…+â€…1</sub>)âˆ’<em>V</em>(<em>s</em><sub><em>t</em></sub>))</span></p>
<p>ä»ç†è®ºä¸Šæ¯”è¾ƒ TD æ–¹æ³•ä¸ MC æ–¹æ³•ã€‚MC æ–¹æ³•ä½¿ç”¨çš„ç´¯è®¡æ”¶ç›Š <span
class="math inline"><em>G</em><sub><em>t</em></sub>(<em>Ï„</em>)</span>
æ˜¯å¯¹ä»·å€¼å‡½æ•° <span
class="math inline"><em>V</em><sup><em>Ï€</em></sup>(<em>s</em>)</span>
çš„æ— åä¼°è®¡ï¼Œè€Œ TD æ–¹æ³•ä½¿ç”¨çš„ TD target
åˆ™ç›¸åº”æ˜¯æœ‰åä¼°è®¡ã€‚ç„¶è€Œå°±ä¼°è®¡æ–¹å·®è€Œè¨€ï¼ŒTD
æ–¹æ³•ç”±äºä»…ä»…æ¶‰åŠåˆ°ä¸€æ­¥å†³ç­–ï¼Œå…¶æ–¹å·®æ˜¾ç„¶è¾ƒ MC æ–¹æ³•å°ã€‚å°±åˆå§‹å€¼æ–¹é¢è€Œè¨€ï¼ŒMC
æ–¹æ³•å¯¹ä¼°è®¡çš„åˆå§‹å€¼è®¾ç½®å¹¶ä¸æ•æ„Ÿï¼Œç„¶è€Œ TD ç”±äºåŸºäº
bootstrapï¼Œæ•…å¯¹åˆå§‹å€¼è®¾ç½®æä¸ºæ•æ„Ÿã€‚</p>
<p>å¦‚æœç®€å•æ€»ç»“ä¸Šè¿°æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹è¿°å›¾ï¼š</p>
<p><img src="/uploads/note-of-rl/1.webp" /></p>
<p>ç®€è€Œè¨€ä¹‹ï¼ŒMC æ–¹æ³•è¾ƒ TD æ–¹æ³•è€Œè¨€æœ‰ç€æ›´æ·±çš„æ¢ç´¢ã€‚è€Œ DP æ–¹æ³•ï¼ˆå°¤å…¶æ˜¯
VIï¼‰åˆ™æ˜¯éå†æ‰€æœ‰å¯èƒ½çš„åç»§çŠ¶æ€è¿›è¡Œæ›´æ–°ï¼Œä»è€Œå…·æœ‰æ›´å¹¿æ³›çš„è§†è§’ï¼Œä¹Ÿå°±æ‹¥æœ‰å¹¿åº¦ã€‚ä¸è¿™ä¸‰è€…å‡ä¸åŒçš„åˆ™æ˜¯æœç´¢ï¼Œå…¶éœ€è¦å®Œæ•´æ¢ç´¢æ•´ä¸ªå†³ç­–æ ‘ï¼Œä½†è¿™è‡ªç„¶æ˜¯ç›¸å½“æµªè´¹èµ„æºçš„ã€‚</p>
<div class="note info no-icon"><p>GPI ä¸­ä½¿ç”¨ TD æ–¹æ³•åšç­–ç•¥è¯„ä¼°çš„ç®—æ³•ä¸€èˆ¬ç§°ä¸º <strong>TD
æ§åˆ¶ç®—æ³•</strong>æˆ–è€…<strong>æ—¶åºå·®åˆ†æ§åˆ¶ç®—æ³•</strong>ã€‚</p>
</div>
<h4 id="å¤šæ­¥-td-target-ä¸-tdlambda">å¤šæ­¥ TD target ä¸ TD(<span
class="math inline"><em>Î»</em></span>)</h4>
<p>TD target äº‹å®ä¸Šå¯ä»¥è®¾ç½®ä¸ºå¤šæ­¥çš„ã€‚ä¼ ç»Ÿçš„ TD target
æ˜¯å•æ­¥çš„ï¼Œå³ä»…ä»…è€ƒè™‘è½¨è¿¹ä¸Šçš„ä¸€æ­¥è½¬ç§»ã€‚è€ƒè™‘å¤šæ­¥ TD
targetï¼Œä¸å¦¨è€ƒè™‘ä¸‰æ­¥ï¼Œå‡å®šè½¨è¿¹ä¸Šæœ‰ä¸‰æ­¥è½¬ç§»ç‰‡æ®µ <span
class="math inline"><em>s</em><sub><em>t</em></sub>,â€†<em>a</em><sub><em>t</em></sub>,â€†<em>r</em><sub><em>t</em>â€…+â€…1</sub>;â€†<em>s</em><sub><em>t</em>â€…+â€…1</sub>,â€†<em>a</em><sub><em>t</em>â€…+â€…1</sub>,â€†<em>r</em><sub><em>t</em>â€…+â€…2</sub>;â€†<em>s</em><sub><em>t</em>â€…+â€…2</sub>,â€†<em>a</em><sub><em>t</em>â€…+â€…2</sub>,â€†<em>r</em><sub><em>t</em>â€…+â€…3</sub>;â€†<em>s</em><sub><em>t</em>â€…+â€…3</sub></span>ï¼Œé‚£ä¹ˆ
TD target å¯ä»¥å®šä¹‰ä¸ºï¼š</p>
<p><span class="math display">$$
{\rm TD\ target} := r_{t + 1} + \gamma r_{t + 2} + \gamma^2 r_{t + 3} +
\gamma^3 V(s_{t + 3})
$$</span></p>
<p>è¿™ä¹Ÿå¯ä»¥ç§°ä¸ºä¸‰æ­¥ TD
targetã€‚äº‹å®ä¸Šï¼Œå¦‚æœä»¤è€ƒè™‘çš„æ­¥æ•°è¶‹å‘äºæ— é™ï¼Œæ— ç©·æ­¥ TD target
ä¹Ÿå°±æˆä¸ºäº†äº‹å®çš„ç´¯è®¡æ”¶ç›Šï¼ŒTD æ–¹æ³•è½¬åŒ–ä¸º MC æ–¹æ³•ã€‚</p>
<p>æˆ‘ä»¬å…ˆå‰æåˆ°è¿‡ï¼ŒTD
æ–¹æ³•å¯¹ä¼°è®¡å€¼åˆå§‹åŒ–æ•æ„Ÿï¼Œä½†æ˜¯å…¶æ•ˆç‡è¾ƒé«˜ã€‚å¦ä¸€æ–¹é¢ï¼ŒMC
æ–¹æ³•å¯¹åˆå§‹å€¼ä¸æ•æ„Ÿï¼Œä½†æ˜¯æ•ˆç‡è¾ƒä½ã€‚æˆ‘ä»¬äº‹å®ä¸Šå¯ä»¥ä½¿ç”¨ä¸€ç§æ–¹æ³•å°†å…¶ä¸¤è€…ç»“åˆï¼Œå³åŸºäºä»‹äº
TD ä¸ MC æ–¹æ³•ä¹‹é—´çš„å¤šæ­¥ TD targetï¼Œåˆ©ç”¨ä¸€å®šçš„æƒé‡å°†å…¶ç»„åˆï¼Œä½œä¸ºæ–°çš„ TD
targetï¼Œè¿™å°±æ˜¯ TD(<span class="math inline"><em>Î»</em></span>)
æ–¹æ³•ã€‚</p>
<p>å°† <span class="math inline"><em>n</em></span> æ­¥ TD target è®°ä¸º
<span
class="math inline"><em>G</em><sub><em>t</em></sub><sup>(<em>n</em>)</sup></span>ï¼Œé‚£ä¹ˆ
TD(<span class="math inline"><em>Î»</em></span>) ä¸­çš„ TD target
å®šä¹‰ä¸ºï¼š</p>
<p><span class="math display">$$
G^\lambda_t := (1 - \lambda)\sum_{n = 1}^{+\infty}\lambda^{n -
1}G_t^{(n)}
$$</span></p>
<p>ä¼ ç»Ÿçš„ TD æ–¹æ³•å³ <span class="math inline"><em>Î»</em>â€„=â€„0</span> çš„
TD(<span class="math inline"><em>Î»</em></span>) æ–¹æ³•ã€‚</p>
<h4 id="backward-view-tdlambda-eligibility-traces">Backward-view
TD(<span class="math inline"><em>Î»</em></span>) &amp; Eligibility
Traces</h4>
<p>ç„¶è€Œä½¿ç”¨ <span class="math inline"><em>Î»</em>â€„â‰ â€„0</span> çš„ TD(<span
class="math inline"><em>Î»</em></span>)
æ–¹æ³•çš„æ—¶å€™æ˜¾ç„¶å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯ç”±äº <span
class="math inline"><em>G</em><sub><em>t</em></sub><sup><em>Î»</em></sup></span>
çš„æ±‚å’Œä¸Šé™æ˜¯ <span
class="math inline">â€…+â€…âˆ</span>ï¼Œè¿™å°±ä»£è¡¨æˆ‘ä»¬éœ€è¦è®©æ™ºèƒ½ä½“åœ¨ç¯å¢ƒä¸­ä¸€ç›´é‡‡æ ·åˆ°è½¨è¿¹ç»ˆæ­¢ã€‚è¿™æ ·çš„è¯äº‹å®ä¸Šå°±è¿èƒŒäº†ä½¿ç”¨
TD(<span class="math inline"><em>Î»</em></span>)
æ–¹æ³•çš„åˆè¡·ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ä¿æŒ TD
æ–¹æ³•çš„æ•ˆç‡çš„åŸºç¡€ä¸Šå¼•å…¥å¤šæ­¥å®é™…é‡‡æ ·æ¥åšåˆ°æ›´ç²¾å‡†çš„ä¼°è®¡ï¼Œæ‰€ä»¥è¦æ±‚é‡‡æ ·åˆ°è½¨è¿¹ç»ˆæ­¢æ˜¯ä¸èƒ½å®¹å¿çš„ã€‚</p>
<p>ä¸€ç§ç®€å•çš„è§£å†³æ–¹å¼ï¼Œé‚£å°±æ˜¯ç”¨ Backward-view TD(<span
class="math inline"><em>Î»</em></span>) å–ä»£ä¸Šé¢çš„ Forward-view TD(<span
class="math inline"><em>Î»</em></span>)ã€‚Forward-view çš„å«ä¹‰æ˜¯é€šè¿‡æœªæ¥çš„
<span
class="math inline"><em>s</em><sub><em>t</em>â€…+â€…1</sub>,â€†<em>s</em><sub><em>t</em>â€…+â€…2</sub>,â€†â‹¯</span>
æ¥æ›´æ–° <span
class="math inline"><em>V</em>(<em>s</em><sub><em>t</em></sub>)</span>
çš„ä¼°è®¡ã€‚è€Œ Backward-view
ä¸ä¹‹ç›¸åï¼Œå…¶é€šè¿‡ä¹‹å‰ç»å†çš„çŠ¶æ€å’Œè½¨è¿¹ç¡®å®šä»·å€¼å‡½æ•°ä¼°è®¡ã€‚</p>
<p>ä¸€ç§ç›´è§‚çš„è§£é‡Šæ˜¯ï¼ŒBackward-view
å°±æ˜¯åæ€å…ˆå‰çš„å“ªä¸€ä¸ªå†³ç­–æ˜¯å¯¼è‡´åˆ°è¾¾å½“å‰çŠ¶æ€çš„æ ¸å¿ƒåŸå› ã€‚</p>
<p>æˆ‘ä»¬å®šä¹‰<strong>æ•ˆç”¨å‡½æ•°ï¼ˆEligibilityï¼‰</strong>ä¸º <span
class="math inline">$E_t(s), s \in \S$</span>ï¼Œè¿™é‡Œä¸‹æ ‡ <span
class="math inline"><em>t</em></span>
è¡¨ç¤ºä¸åŒçš„æ—¶é—´çš„æ•ˆç”¨å‡½æ•°éƒ½æ˜¯ä¸åŒçš„ã€‚æˆ‘ä»¬å¼•å…¥æ•ˆç”¨å‡½æ•°çš„ç›®çš„æ˜¯å°†å…¶ä½œä¸ºæƒé‡å¼•å…¥ä»·å€¼å‡½æ•°æ›´æ–°æµç¨‹ä¸­ï¼Œè¡¨ç¤º
TD error ä»¥å¤šå¤§ç¨‹åº¦å½±å“ä»·å€¼å‡½æ•°ä¼°è®¡ï¼š</p>
<p><span
class="math display"><em>V</em>(<em>s</em><sub><em>t</em></sub>)â€„â†â€„<em>V</em>(<em>s</em><sub><em>t</em></sub>)â€…+â€…<em>Î±</em><em>Î´</em><sub><em>t</em></sub><em>E</em><sub><em>t</em></sub>(<em>s</em><sub><em>t</em></sub>)â€„=â€„<em>V</em>(<em>s</em><sub><em>t</em></sub>)â€…+â€…<em>Î±</em><em>E</em><sub><em>t</em></sub>(<em>s</em><sub><em>t</em></sub>)(<em>r</em><sub><em>t</em>â€…+â€…1</sub>+<em>Î³</em><em>V</em>(<em>s</em><sub><em>t</em>â€…+â€…1</sub>)âˆ’<em>V</em>(<em>s</em><sub><em>t</em></sub>))</span></p>
<p>ç„¶åï¼Œå®šä¹‰æ•ˆç”¨å‡½æ•°çš„åˆå§‹åŒ–å’Œæ›´æ–°åŸåˆ™ï¼š</p>
<p><span class="math display">$$
\begin{aligned}
&amp;E_0(s) = 0, \forall s \in \S \\
&amp;E_t(s) = \gamma\lambda E_{t - 1}(s) + \b{1}(s_t = s), \forall t \in
\mathbb{N}^+, s \in \S \\
\end{aligned}
$$</span></p>
<p>ç°åœ¨ç®€å•ä»æ•°å­¦è§’åº¦è¯´æ˜ä½¿ç”¨æ•ˆç”¨å‡½æ•°çš„ Backward-view TD(<span
class="math inline"><em>Î»</em></span>) ä¸ Forward-view TD(<span
class="math inline"><em>Î»</em></span>)
æ–¹æ³•ç­‰ä»·ã€‚ä¸ºäº†ç®€åŒ–ï¼Œè¿™é‡Œå‡è®¾è½¨è¿¹ä¸­ç»å†è¿‡çš„çŠ¶æ€åç»­ä¸åœ¨ç»è¿‡ã€‚å‡è®¾æˆ‘ä»¬åœ¨
<span class="math inline"><em>k</em></span> æ—¶åˆ»åˆ°è¾¾äº†çŠ¶æ€ <span
class="math inline"><em>s</em><sub><em>k</em></sub></span>ï¼Œé‚£ä¹ˆï¼š</p>
<p><span class="math display">$$
E_t(s_k) = \begin{cases}
0 &amp; t &lt; k \\
(\gamma\lambda)^{t - k} &amp; t \geq k \\
\end{cases}
$$</span></p>
<p>é‚£ä¹ˆä½¿ç”¨æ•ˆç”¨å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬åœ¨è¿­ä»£ç»ˆæ­¢æ—¶å¾—åˆ°çš„çŠ¶æ€ <span
class="math inline"><em>s</em><sub><em>k</em></sub></span>
çš„ä»·å€¼å‡½æ•°ä¼°è®¡ä¸ºï¼ˆä»·å€¼å‡½æ•°ä¸Šæ ‡ <span class="math inline">${\rm
B}$</span> è¡¨ç¤ºåå‘è§†è§’ï¼‰ï¼š</p>
<p><span class="math display">$$
V_{+\infty}^{\rm B}(s_k) = V_0(s_k) + \sum_{t = 1}^{+\infty}
\alpha\delta_tE_t(s_k) = V_0(s_k) + \alpha\sum_{t = k}^{+\infty}
(\gamma\lambda)^{t - k}\delta_t = V_0(s_k) + \alpha\sum_{t =
0}^{+\infty} (\gamma\lambda)^t\delta_{t + k}
$$</span></p>
<p>è€ƒè™‘ä¸‹è¿°è®¡ç®—ï¼š</p>
<p><span class="math display">$$
\begin{aligned}
G_t^\lambda - V_t(s_t) &amp;= -V_t(s_t) + (1 - \lambda)\sum_{n =
1}^{+\infty}\lambda^{n - 1}G_t^{(n)} \\
&amp;= -V_t(s_t) + (1 - \lambda)\sum_{n = 1}^{+\infty}\lambda^{n -
1}\left(\gamma^nV_t(s_{t + n}) + \sum_{i = 1}^n \gamma^{i - 1}r_{t +
i}\right) \\
&amp;= -V_t(s_t) + \sum_{n = 1}^{+\infty}\lambda^{n -
1}\left(\gamma^nV_t(s_{t + n}) + \sum_{i = 1}^n \gamma^{i - 1}r_{t +
i}\right) -  \sum_{n = 1}^{+\infty}\lambda^n\left(\gamma^nV_t(s_{t + n})
+ \sum_{i = 1}^n \gamma^{i - 1}r_{t + i}\right) \\
&amp;= -V_t(s_t) + \sum_{n = 0}^{+\infty}\lambda^n\left(\gamma^{n +
1}V_t(s_{t + n + 1}) + \sum_{i = 1}^{n + 1} \gamma^{i - 1}r_{t +
i}\right) -  \sum_{n = 1}^{+\infty}\lambda^n\left(\gamma^nV_t(s_{t + n})
+ \sum_{i = 1}^n \gamma^{i - 1}r_{t + i}\right) \\
&amp;= -V_t(s_t) + \gamma V_t(s_{t + 1}) + r_{t + 1} + \sum_{n =
1}^{+\infty} \lambda^n\left(\gamma^{n + 1}V_t(s_{t + n + 1}) -
\gamma^nV_t(s_{t + n}) + \gamma^nr_{t + n + 1}\right) \\
&amp;= \sum_{n = 0}^{+\infty} \lambda^n\left(\gamma^{n + 1}V_t(s_{t + n
+ 1}) - \gamma^nV_t(s_{t + n}) + \gamma^nr_{t + n + 1}\right) \\
&amp;= \sum_{n = 0}^{+\infty} \gamma^n\lambda^n\left(\gamma V_t(s_{t + n
+ 1}) - V_t(s_{t + n}) + r_{t + n + 1}\right) \\
&amp;\approx \sum_{n = 0}^{+\infty} \gamma^n\lambda^n\left(\gamma V_{t +
n}(s_{t + n + 1}) - V_{t + n}(s_{t + n}) + r_{t + n + 1}\right) \\
&amp;= \sum_{n = 0}^{+\infty} (\gamma\lambda)^n\delta_{t + n}
\end{aligned}
$$</span></p>
<p>è¿™å°±è¯´æ˜é€šè¿‡æ•ˆç”¨å‡½æ•°ï¼Œæˆ‘ä»¬æœ€ç»ˆå¾—åˆ°çš„çŠ¶æ€ <span
class="math inline"><em>s</em><sub><em>k</em></sub></span>
çš„ä»·å€¼å‡½æ•°ä¼°è®¡ä¸ºï¼š</p>
<p><span class="math display">$$
V_{+\infty}^{\rm B}(s_k) = V_0(s_k) + \alpha(G_k^\lambda - V_k(s_k))
$$</span></p>
<p>è€Œå¦‚æœé€šè¿‡ Forward-view TD(<span
class="math inline"><em>Î»</em></span>)ï¼Œç”±äºåç»­ä¸åœ¨ç»å† <span
class="math inline"><em>s</em><sub><em>k</em></sub></span>ï¼Œé‚£ä¹ˆ <span
class="math inline"><em>s</em><sub><em>k</em></sub></span>
çš„ä»·å€¼å‡½æ•°åªä¼šåœ¨æ—¶åˆ» <span class="math inline"><em>k</em></span>
å‘ç”Ÿä¸€æ­¥æ›´æ–°ï¼Œå…¶ä½™æ—¶åˆ»å¹¶ä¸æ›´æ–°ã€‚è€Œåœ¨æ—¶åˆ» <span
class="math inline"><em>k</em></span>ï¼ŒTD target ä¸º <span
class="math inline"><em>G</em><sub><em>k</em></sub><sup><em>Î»</em></sup></span>ï¼Œå³å¯å¾—åˆ°æœ€ç»ˆçš„ä»·å€¼å‡½æ•°ä¼°è®¡ï¼ˆä»·å€¼å‡½æ•°ä¸Šæ ‡
<span class="math inline">${\rm F}$</span> è¡¨ç¤ºå‰å‘è§†è§’ï¼‰ï¼š</p>
<p><span class="math display">$$
V_{+\infty}^{\rm F}(s_k) = V_0(s_k) + \alpha(G_k^\lambda - V_k(s_k))
$$</span></p>
<p>ä»è€Œè¯æ˜å®Œæ¯•ã€‚äº‹å®ä¸Šï¼Œå¦‚æœå»æ‰çŠ¶æ€ä¸é‡å¤çš„å‡è®¾ï¼Œä¹Ÿåªæ˜¯æŠŠæ¯æ¬¡ç»è¿‡è¯¥çŠ¶æ€æ—¶çš„çŠ¶æ€å‡½æ•°å€¼å˜åŒ–æ‹†å¼€ï¼Œæ¯ä¸€éƒ¨åˆ†éƒ½å¯ä»¥é€šè¿‡ä¸Šé¢çš„è¿‡ç¨‹è¯æ˜ä¸¤ä¸ªè§†è§’çš„ç­‰ä»·æ€§ï¼Œä»è€Œæ±‚å’Œåä¾ç„¶æ˜¯ç­‰ä»·çš„ã€‚</p>
<div class="note info no-icon"><p>è¿™é‡Œç®€å•è¯´æ˜ RL
ä¸­<strong>åœ¨çº¿ï¼ˆOnlineï¼‰</strong>å’Œ<strong>ç¦»çº¿ï¼ˆOfflineï¼‰</strong>çš„åŒºåˆ«ã€‚åœ¨çº¿æŒ‡çš„æ˜¯æ™ºèƒ½ä½“é€šè¿‡ç­–ç•¥æ”¶é›†ç¯å¢ƒä¿¡æ¯å’Œé€šè¿‡è¿™äº›ä¿¡æ¯æ›´æ–°ç­–ç•¥æ˜¯åŒæ—¶çš„ï¼Œè€Œç¦»çº¿åˆ™æŒ‡çš„æ˜¯é€šè¿‡æŸä¸ªå›ºå®šç­–ç•¥åœ¨ç¯å¢ƒä¸­æ”¶é›†ä¿¡æ¯ï¼Œç„¶åç¦»çº¿é€šè¿‡è¿™äº›æ•°æ®æ›´æ–°ç­–ç•¥ã€‚</p>
<p>åœ¨çº¿ç®—æ³•çš„ç‰¹å¾åœ¨äºä»·å€¼å‡½æ•°ä¼°è®¡åœ¨æ¯ä¸ªæ—¶é—´æ­¥éƒ½ä¼šå‘ç”Ÿæ›´æ–°ã€‚è€Œç¦»çº¿ç®—æ³•ç”±äºå·²ç»äº‹å…ˆé‡‡é›†è‹¥å¹²æ¡è½¨è¿¹ï¼Œæ‰€ä»¥æ›´æ–°çš„ç²’åº¦æ˜¯æ•´æ¡è½¨è¿¹ï¼Œå³å®Œæ•´è€ƒè™‘ä¸€æ¡è½¨è¿¹ï¼Œæ¯æ¬¡å®Œæ•´è¯»å–å®Œä¸€æ¡è½¨è¿¹ååšä¸€æ¬¡ä»·å€¼å‡½æ•°ä¼°è®¡æ›´æ–°ã€‚</p>
<p>ä¸Šè¿°æ¨ç†ä¸­ä½¿ç”¨äº†çº¦ç­‰äºï¼Œè¿™ä»…é™äºåœ¨çº¿åœºæ™¯ï¼Œè€Œå¯¹äºç¦»çº¿åœºæ™¯ï¼Œä»·å€¼å‡½æ•°
<span class="math inline"><em>V</em><sub><em>t</em></sub></span> ä¸­ä¸‹æ ‡
<span class="math inline"><em>t</em></span>
å³å¤±æ•ˆï¼ˆä¸å†æ¯ä¸ªæ—¶é—´æ­¥æ›´æ–°ï¼‰ï¼Œæ­¤æ—¶çº¦ç­‰äºå˜ä¸ºä¸¥æ ¼ç­‰äºã€‚è¿™ä¹Ÿå°±è¯´æ˜ä¸¤ä¸ªè§†è§’åœ¨ç¦»çº¿æ¡ä»¶ä¸‹æ˜¯ä¸¥æ ¼ç­‰ä»·ï¼Œåœ¨åœ¨çº¿æ¡ä»¶ä¸‹æ˜¯å¤§è‡´ç­‰ä»·ã€‚</p>
</div>
<h2 id="ç­–ç•¥æ”¹è¿›">ç­–ç•¥æ”¹è¿›</h2>
<p>ç­–ç•¥æ”¹è¿›çš„æ–¹å¼å®é™…ä¸Šä¸æ‹˜ä¸€æ ¼ï¼Œè¿™å’Œç­–ç•¥è¯„ä¼°ç›¸å¯¹æ‰‹æ®µæœ‰é™å½¢æˆå¯¹æ¯”çš„åŸå› æ˜¯ï¼Œç­–ç•¥è¯„ä¼°ä¸¥æ ¼è¦æ±‚ä»·å€¼å‡½æ•°æ”¶æ•›åˆ°å½“å‰ç­–ç•¥ï¼ˆé‡‡ç”¨å¼‚è½¨æ–¹æ³•æ—¶æ˜¯å½“å‰ç›®æ ‡ç­–ç•¥ï¼‰çš„çœŸå®ä»·å€¼å‡½æ•°ï¼Œè€Œç­–ç•¥æ”¹è¿›ä»…ä»…æ˜¯è¦æ±‚è´ªå¿ƒåœ°ç”Ÿæˆï¼Œå¹¶æ²¡æœ‰ä¸¥æ ¼è¦æ±‚ç”Ÿæˆæ–¹å¼ã€‚</p>
<p>å¸¸è§çš„ç­–ç•¥æ”¹è¿›ä¹‹ä¸€å°±æ˜¯<strong>å®Œå…¨è´ªå¿ƒç­–ç•¥ï¼ˆGreedy
Policyï¼‰</strong>ï¼Œæœ€ä¼˜ Bellman æ–¹ç¨‹ <span
class="math inline">$V^\star(s) = \max_{a \in \A} Q^\star(s, a)$</span>
ä¿è¯äº†å®Œå…¨è´ªå¿ƒç­–ç•¥ä¾ç„¶å¯ä»¥æ”¶æ•›åˆ°æœ€ä¼˜ç­–ç•¥ï¼š</p>
<p><span class="math display">$$
\pi(a \mid s) := \begin{cases}
1 &amp; a = \argmax_{a' \in \A} Q(s, a') \\
0 &amp; {\rm otherwise} \\
\end{cases}
$$</span></p>
<p>ç„¶è€Œè¿™ç§æ–¹æ³•å¹¶ä¸ä¸€å®šåœ¨å®é™…ä¸Šä¼˜è¶Šï¼Œè¿™æ˜¯å› ä¸ºä¸€ä¸ªç­–ç•¥å¾€å¾€éœ€è¦åŒæ—¶è€ƒè™‘ä¸‹é¢ä¸¤ç§ç›¸å¯¹ç«‹çš„ä¼˜åŒ–ç›®æ ‡ï¼š</p>
<ul>
<li>ï¼ˆExplorationï¼‰èƒ½å¤Ÿå……åˆ†æ¢ç´¢æœªçŸ¥çš„çŠ¶æ€å’Œè¡Œä¸ºï¼Œå¢åŠ å¯¹ç¯å¢ƒçš„è®¤è¯†</li>
<li>ï¼ˆExploitationï¼‰èƒ½å¤Ÿå……åˆ†åˆ©ç”¨å·²ç»æŒæ¡çš„ç¯å¢ƒä¿¡æ¯ï¼Œè·å–å°½å¯èƒ½é«˜çš„ç´¯è®¡æ”¶ç›Š</li>
</ul>
<p>Exploration ä¼šè¦æ±‚è¡Œä¸ºç­–ç•¥æ›´åŠ æ¿€è¿›è€Œ Exploitation
ä¼šè¦æ±‚ç›®æ ‡ç­–ç•¥æ›´åŠ ä¿å®ˆï¼Œå¦‚ä½•å¹³è¡¡è¿™ä¸¤è€…ä»¥è·å–é«˜æ”¶ç›Šä¹Ÿå°±æ˜¯è¿™ä¸€ç±» RL
æ–¹æ³•çš„æ ¸å¿ƒã€‚</p>
<p>ä¸€ç§ç®€å•çš„æ–¹å¼æ˜¯ <strong><span class="math inline"><em>Îµ</em></span>
è´ªå¿ƒç­–ç•¥ï¼ˆ<span class="math inline"><em>Îµ</em></span> Greedy
Policyï¼‰</strong>ï¼Œå…¶è¡¨ç°ä¸ºï¼š</p>
<p><span class="math display">$$
\pi(a \mid s) := \begin{cases}
\varepsilon / |\A| + 1 - \varepsilon &amp; a = \argmax_{a' \in \A} Q(s,
a') \\
\varepsilon / |\A| &amp; {\rm otherwise} \\
\end{cases}
$$</span></p>
<p>å½“ç„¶ï¼Œè¿˜ä¼šæœ‰ç±»ä¼¼ <strong>Boltzman
æ¢ç´¢</strong>ä¹‹ç±»çš„å¹¶ä¸å¸¸è§çš„ç­–ç•¥æ”¹è¿›ï¼š</p>
<p><span class="math display">$$
\pi(a \mid s) := \frac{\exp(Q(s, a) / T)}{\sum_{a' \in \A} \exp(Q(s, a')
/ T)}
$$</span></p>
<div class="note success no-icon"><p><strong>Definition 3.01 (GLIE)</strong> å‡è®¾ç¬¬ <span
class="math inline"><em>k</em></span> æ—¶åˆ»ç­–ç•¥æ”¹è¿›å¾—åˆ°ç­–ç•¥ <span
class="math inline"><em>Ï€</em><sub><em>k</em></sub></span>ï¼ŒçŠ¶æ€è¡Œä¸ºä»·å€¼å‡½æ•°
<span class="math inline"><em>Q</em><sub><em>k</em></sub></span>ï¼Œè®°ç»è¿‡
<span class="math inline"><em>k</em></span> æ—¶é•¿åç­–ç•¥åœ¨çŠ¶æ€ <span
class="math inline"><em>s</em></span> å¤„åšå‡ºå†³ç­– <span
class="math inline"><em>a</em></span> çš„æ¬¡æ•°ä¸º <span
class="math inline"><em>N</em>(<em>s</em>,<em>a</em>)</span>ã€‚æˆ‘ä»¬ç§°è¯¥ç­–ç•¥æ”¹è¿›æ˜¯
<strong>Greedy in the Limit with Infinite Exploration
(GLIE)</strong>ï¼Œå¦‚æœï¼š</p>
<ul>
<li>å……åˆ†é•¿æ—¶é—´åæ‰€æœ‰çŠ¶æ€å†³ç­–å¯¹å‡æ¢ç´¢æ— ç©·æ¬¡</li>
</ul>
<p><span class="math display">$$
\lim_{k \to +\infty} N_k(s, a) = +\infty, \forall s \in \S, a \in \A
$$</span></p>
<ul>
<li>ç­–ç•¥æœ€ç»ˆæ”¶æ•›åˆ°è´ªå¿ƒç­–ç•¥</li>
</ul>
<p><span class="math display">$$
\lim_{k \to +\infty} \pi_k(a \mid s) = \b{1}\left(a = \argmax_{a' \in
\A} Q_k(s, a')\right), \forall s \in \S, a \in \A
$$</span></p>
</div>
<p>Boltzman æ¢ç´¢æ˜¯ GLIEï¼Œè€Œ <span class="math inline"><em>Îµ</em></span>
è´ªå¿ƒç­–ç•¥åˆ™å¯èƒ½ä¸æ˜¯ GLIEã€‚</p>
<h1 id="æ—¶åºå·®åˆ†æ§åˆ¶">æ—¶åºå·®åˆ†æ§åˆ¶</h1>
<p>æ—¶åºå·®åˆ†æ§åˆ¶çš„ä¸€èˆ¬æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ul>
<li>åˆå§‹åŒ–ç›®æ ‡ç­–ç•¥ <span class="math inline"><em>Ï€</em></span>
ä»¥åŠä»·å€¼å‡½æ•° <span
class="math inline"><em>Q</em><sup><em>Ï€</em></sup></span></li>
<li>å¾ªç¯æ‰§è¡Œä¸‹è¿°æ­¥éª¤ç›´åˆ°æ”¶æ•›
<ul>
<li>ã€ç­–ç•¥æ”¹è¿›ã€‘åˆ©ç”¨ <span
class="math inline"><em>Q</em><sup><em>Ï€</em></sup></span>
ç”Ÿæˆ<strong>è¡Œä¸ºç­–ç•¥</strong>å¹¶æ‰§è¡Œ<strong>ä¸€æ¬¡</strong>ï¼Œé‡‡æ ·å¾—åˆ°<strong>ä¸€æ­¥çŠ¶æ€è½¬ç§»</strong></li>
<li>ã€ç­–ç•¥è¯„ä¼°ã€‘æ ¹æ®è¡Œä¸ºç­–ç•¥å¾—åˆ°çš„ä¸€æ­¥çŠ¶æ€è½¬ç§»æ›´æ–°<strong>ç›®æ ‡ç­–ç•¥</strong>
<span class="math inline"><em>Ï€</em></span> çš„ä»·å€¼å‡½æ•° <span
class="math inline"><em>Q</em><sup><em>Ï€</em></sup></span></li>
</ul></li>
</ul>
<h2 id="åŒè½¨æ—¶åºå·®åˆ†æ§åˆ¶sarsa">åŒè½¨æ—¶åºå·®åˆ†æ§åˆ¶ï¼ˆSARSAï¼‰</h2>
<p>åœ¨åŒè½¨æ—¶åºå·®åˆ†æ§åˆ¶ä¹‹ä¸­ä½¿ç”¨ <span
class="math inline"><em>Îµ</em></span> è´ªå¿ƒç­–ç•¥å³å¯å¾—åˆ° SARSA
ç®—æ³•ã€‚è‹¥ä»¤æ—¶åˆ» <span class="math inline"><em>t</em></span>
æ™ºèƒ½ä½“ä½äºçŠ¶æ€ <span
class="math inline"><em>s</em><sub><em>t</em></sub></span>ï¼Œåšå‡ºå†³ç­–
<span class="math inline"><em>a</em><sub><em>t</em></sub></span>
è½¬ç§»åˆ°çŠ¶æ€ <span
class="math inline"><em>s</em><sub><em>t</em>â€…+â€…1</sub></span>
å¹¶è·å¾—æ”¶ç›Š <span
class="math inline"><em>r</em><sub><em>t</em>â€…+â€…1</sub></span>ï¼Œå¦‚æœå…¶ä¸‹ä¸€æ—¶åˆ»åšå‡ºå†³ç­–
<span
class="math inline"><em>a</em><sub><em>t</em>â€…+â€…1</sub></span>ï¼Œå¯ä»¥å¾—åˆ°å…¶ç­–ç•¥è¯„ä¼°é˜¶æ®µæ‰€é‡‡ç”¨çš„æ›´æ–°ä¸ºï¼š</p>
<p><span
class="math display"><em>Q</em>(<em>s</em><sub><em>t</em></sub>,<em>a</em><sub><em>t</em></sub>)â€„â†â€„<em>Q</em>(<em>s</em><sub><em>t</em></sub>,<em>a</em><sub><em>t</em></sub>)â€…+â€…<em>Î±</em>[<em>r</em><sub><em>t</em>â€…+â€…1</sub>+<em>Î³</em><em>Q</em>(<em>s</em><sub><em>t</em>â€…+â€…1</sub>,<em>a</em><sub><em>t</em>â€…+â€…1</sub>)âˆ’<em>Q</em>(<em>s</em><sub><em>t</em></sub>,<em>a</em><sub><em>t</em></sub>)]</span></p>
<h2 id="å¼‚è½¨æ—¶åºå·®åˆ†æ§åˆ¶q-learning">å¼‚è½¨æ—¶åºå·®åˆ†æ§åˆ¶ï¼ˆQ learningï¼‰</h2>
<p>åœ¨å¼‚è½¨æ—¶åºå·®åˆ†æ§åˆ¶ä¸­ï¼Œä»¤ç›®æ ‡ç­–ç•¥ä¸ºå®Œå…¨è´ªå¿ƒç­–ç•¥ï¼Œè¡Œä¸ºç­–ç•¥ä¸º <span
class="math inline"><em>Îµ</em></span> è´ªå¿ƒç­–ç•¥å³å¯å¾—åˆ° Q learning
ç®—æ³•ã€‚è‹¥ä»¤æ—¶åˆ» <span class="math inline"><em>t</em></span>
æ™ºèƒ½ä½“ä½äºçŠ¶æ€ <span
class="math inline"><em>s</em><sub><em>t</em></sub></span>ï¼Œåšå‡ºå†³ç­–
<span class="math inline"><em>a</em><sub><em>t</em></sub></span>
è½¬ç§»åˆ°çŠ¶æ€ <span
class="math inline"><em>s</em><sub><em>t</em>â€…+â€…1</sub></span>
å¹¶è·å¾—æ”¶ç›Š <span
class="math inline"><em>r</em><sub><em>t</em>â€…+â€…1</sub></span>ï¼Œå¯ä»¥å¾—åˆ°å…¶ç­–ç•¥è¯„ä¼°é˜¶æ®µæ‰€é‡‡ç”¨çš„æ›´æ–°ä¸ºï¼š</p>
<p><span class="math display">$$
Q(s_t, a_t) \leftarrow Q(s_t, a_t) + \alpha\left[r_{t + 1} +
\gamma\max_{a \in \A} Q(s_{t + 1}, a) - Q(s_t, a_t)\right]
$$</span></p>
<h1 id="è’™ç‰¹å¡æ´›æ§åˆ¶">è’™ç‰¹å¡æ´›æ§åˆ¶</h1>
<p>è’™ç‰¹å¡æ´›æ§åˆ¶çš„ä¸€èˆ¬æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ul>
<li>åˆå§‹åŒ–ç›®æ ‡ç­–ç•¥ <span class="math inline"><em>Ï€</em></span>
ä»¥åŠä»·å€¼å‡½æ•° <span
class="math inline"><em>Q</em><sup><em>Ï€</em></sup></span></li>
<li>å¾ªç¯æ‰§è¡Œä¸‹è¿°æ­¥éª¤ç›´åˆ°æ”¶æ•›
<ul>
<li>ã€ç­–ç•¥æ”¹è¿›ã€‘åˆ©ç”¨ <span
class="math inline"><em>Q</em><sup><em>Ï€</em></sup></span>
ç”Ÿæˆ<strong>è¡Œä¸ºç­–ç•¥</strong>å¹¶æ‰§è¡Œ<strong>è‡³ç»ˆæ­¢</strong>ï¼Œé‡‡æ ·å¾—åˆ°<strong>ä¸€æ¡å®Œæ•´è½¨è¿¹</strong></li>
<li>ã€ç­–ç•¥è¯„ä¼°ã€‘æ ¹æ®è¡Œä¸ºç­–ç•¥å¾—åˆ°çš„è½¨è¿¹æ›´æ–°<strong>ç›®æ ‡ç­–ç•¥</strong>
<span class="math inline"><em>Ï€</em></span> çš„ä»·å€¼å‡½æ•° <span
class="math inline"><em>Q</em><sup><em>Ï€</em></sup></span></li>
</ul></li>
</ul>
<h2 id="åŒè½¨è’™ç‰¹å¡æ´›æ§åˆ¶">åŒè½¨è’™ç‰¹å¡æ´›æ§åˆ¶</h2>
<p>è‹¥åœ¨é‡‡æ ·å¾—åˆ°çš„è½¨è¿¹ <span class="math inline"><em>Ï„</em></span>
ä¸­ï¼Œæ—¶åˆ» <span class="math inline"><em>t</em></span> æ™ºèƒ½ä½“ä½äºçŠ¶æ€
<span
class="math inline"><em>s</em><sub><em>t</em></sub></span>ï¼Œåšå‡ºå†³ç­–
<span class="math inline"><em>a</em><sub><em>t</em></sub></span>
è½¬ç§»åˆ°çŠ¶æ€ <span
class="math inline"><em>s</em><sub><em>t</em>â€…+â€…1</sub></span>
å¹¶è·å¾—æ”¶ç›Š <span
class="math inline"><em>r</em><sub><em>t</em>â€…+â€…1</sub></span>ï¼Œå¯ä»¥å¾—åˆ°å…¶ç­–ç•¥è¯„ä¼°é˜¶æ®µæ‰€é‡‡ç”¨çš„æ›´æ–°ä¸ºï¼š</p>
<p><span
class="math display"><em>Q</em>(<em>s</em><sub><em>t</em></sub>,<em>a</em><sub><em>t</em></sub>)â€„â†â€„<em>Q</em>(<em>s</em><sub><em>t</em></sub>,<em>a</em><sub><em>t</em></sub>)â€…+â€…<em>Î±</em>[<em>G</em><sub><em>t</em></sub>(<em>Ï„</em>)âˆ’<em>Q</em>(<em>s</em><sub><em>t</em></sub>,<em>a</em><sub><em>t</em></sub>)]</span></p>
<h2 id="å¼‚è½¨è’™ç‰¹å¡æ´›æ§åˆ¶">å¼‚è½¨è’™ç‰¹å¡æ´›æ§åˆ¶</h2>
<p>ç°åœ¨æˆ‘ä»¬éœ€è¦è€ƒè™‘å¼‚è½¨å¸¦æ¥çš„ä¸€ä¸ªé‡è¦é—®é¢˜ï¼Œæˆ‘ä»¬é€šè¿‡è¡Œä¸ºç­–ç•¥é‡‡æ ·å¾—åˆ°çš„æ•°æ®ç›´æ¥æ›´æ–°ç›®æ ‡ç­–ç•¥çš„ä»·å€¼å‡½æ•°ä¼°è®¡æ˜¯å¦åˆç†ã€‚åœ¨æ—¶åºå·®åˆ†æ§åˆ¶ä¸­æˆ‘ä»¬å¹¶æ²¡æœ‰æ€è€ƒè¿™ä¸€é—®é¢˜ï¼Œä»…ä»…æ˜¯ç”±äºæ—¶åºå·®åˆ†æ§åˆ¶ä¸­ï¼Œè¡Œä¸ºç­–ç•¥å’Œç›®æ ‡ç­–ç•¥çš„æ›´æ–°æ¯æ­¥éƒ½åœ¨è¿›è¡Œï¼Œä¸¤è€…å¯ä»¥è®¤ä¸ºç›¸å¯¹æ¥è¿‘ï¼Œä»è€Œå¯ä»¥å¿½ç•¥è¿™ä¸€é—®é¢˜ï¼Œå¹¶ä¸æ˜¯è¯´æ˜æ—¶åºå·®åˆ†æ§åˆ¶ä¸­ä¸å­˜åœ¨è¿™ä¸€é—®é¢˜ã€‚ä¾‹å¦‚ï¼ŒQ
learning çš„æ›´æ–°å…¬å¼ä¸­ï¼š</p>
<p><span class="math display">$$
Q(s_t, a_t) \leftarrow Q(s_t, a_t) + \alpha\left[r_{t + 1} +
\gamma{\color{red} \max_{a \in \A} Q(s_{t + 1}, a)} - Q(s_t, a_t)\right]
$$</span></p>
<p>è¿™é‡Œ <span
class="math inline"><em>s</em><sub><em>t</em>â€…+â€…1</sub></span>
æ˜¯é€šè¿‡è¡Œä¸ºç­–ç•¥ç¡®å®šçš„ï¼Œç„¶è€Œåœ¨æ›´æ–°çš„æ—¶å€™åˆ™ç›´æ¥ä½¿ç”¨å…¶è®¡ç®—ç›®æ ‡ç­–ç•¥ï¼ˆå®Œå…¨è´ªå¿ƒç­–ç•¥ï¼‰ä»·å€¼å‡½æ•°çš„
TD targetã€‚</p>
<p>ç„¶è€Œåœ¨è’™ç‰¹å¡æ´›æ§åˆ¶ä¸­è¿™ä¸€é—®é¢˜åˆ™è¾ƒä¸ºæ˜æ˜¾ï¼Œå› ä¸ºè¡Œä¸ºç­–ç•¥ä¼šç›´æ¥é‡‡æ ·å¾—åˆ°ä¸€æ•´æ¡è½¨è¿¹ï¼Œå…¶ä¼šå¯¼è‡´ç›®æ ‡ç­–ç•¥ä»·å€¼å‡½æ•°çš„å¤§æ‰¹é‡æ›´æ–°ã€‚</p>
<p>è¯¥é—®é¢˜å¯ä»¥å½¢å¼åŒ–å®šä¹‰ä¸ºï¼Œå·²çŸ¥è¡Œä¸ºç­–ç•¥ <span
class="math inline"><em>b</em></span> ä¸ç›®æ ‡ç­–ç•¥ <span
class="math inline"><em>Ï€</em></span>ï¼Œä»¥åŠä½¿ç”¨è¡Œä¸ºç­–ç•¥ <span
class="math inline"><em>b</em></span> é‡‡æ ·å¾—åˆ°çš„è½¨è¿¹ <span
class="math inline"><em>Ï„</em></span>ï¼Œæˆ‘ä»¬åº”å½“å¦‚ä½•æ‹Ÿåˆè®¡ç®—ç›®æ ‡ç­–ç•¥çš„ä»·å€¼å‡½æ•°
<span class="math inline"><em>Q</em><sup><em>Ï€</em></sup></span>ã€‚</p>
<p>æ­¤æ—¶ä¸€èˆ¬ä¼šä½¿ç”¨<strong>é‡è¦æ€§é‡‡æ ·</strong>æ–¹æ³•ã€‚æˆ‘ä»¬è€ƒè™‘éšæœºå˜é‡ <span
class="math inline"><em>X</em></span> ä»¥åŠå…¶æ¦‚ç‡å¯†åº¦å‡½æ•° <span
class="math inline">$f_X(x) := \P(X = x)$</span>ï¼Œéšæœºå˜é‡ <span
class="math inline"><em>X</em></span> çš„æœŸæœ›æ˜¾ç„¶å®šä¹‰ä¸ºï¼š</p>
<p><span class="math display">$$
\Eop_{x \sim X}[x] := \int_{\mathbb R} xf_X(x) \d x
$$</span></p>
<p>å¹¶ä¸”å¯¹äºä»»ä½•å®æ•°é›†ä¸Šçš„å‡½æ•° <span
class="math inline"><em>Ï†</em></span> éƒ½æœ‰ï¼š</p>
<p><span class="math display">$$
\Eop_{x \sim X}[\varphi(x)] := \int_{\mathbb R} \varphi(x)f_X(x) \d x
$$</span></p>
<p>ä¸ºäº†ä¼°ç®— <span
class="math inline">$\E[\varphi(X)]$</span>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é‡‡æ ·å¹¶åˆ©ç”¨æ ·æœ¬å‡å€¼ä½œä¸ºæ•°å­¦æœŸæœ›çš„ä¼°è®¡å€¼ã€‚ä¾‹å¦‚æˆ‘ä»¬é‡‡æ ·è·å–äº†
<span class="math inline"><em>X</em></span> çš„ <span
class="math inline"><em>N</em></span> ä¸ªå€¼ <span
class="math inline"><em>x</em><sub>1</sub>,â€†<em>x</em><sub>2</sub>,â€†â‹¯,â€†<em>x</em><sub><em>N</em></sub></span>ï¼Œé‚£ä¹ˆï¼š</p>
<p><span class="math display">$$
\Eop_{x \sim X}[\varphi(x)] \approx \frac{1}{N}\sum_{k = 1}^N
\varphi(x_k)
$$</span></p>
<p>ç„¶è€Œå¦‚æœåˆ†å¸ƒ <span
class="math inline"><em>f</em><sub><em>X</em></sub></span>
å¹¶ä¸å®¹æ˜“é‡‡æ ·ï¼Œé‚£ä¹ˆè¿™ä¸€æ¡è·¯çº¿å°±æœ‰å¯èƒ½å‡ºç°é—®é¢˜ã€‚æ­¤æ—¶ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå®¹æ˜“é‡‡æ ·çš„åˆ†å¸ƒ
<span
class="math inline"><em>f</em><sub><em>Y</em></sub></span>ï¼Œåˆ™æˆ‘ä»¬è€ƒè™‘ï¼š</p>
<p><span class="math display">$$
\Eop_{x \sim X}[\varphi(x)] := \int_{\mathbb R} \varphi(x)f_X(x) \d x =
\int_{\mathbb R} \varphi(x)\frac{f_X(x)}{f_Y(x)} f_Y(x) \d x = \Eop_{y
\sim Y}\left[\frac{f_X(y)}{f_Y(y)}\varphi(y)\right]
$$</span></p>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç›´æ¥é‡‡æ · <span
class="math inline"><em>f</em><sub><em>X</em></sub></span>ï¼Œä»…éœ€è¦å¾—çŸ¥
<span class="math inline"><em>f</em><sub><em>X</em></sub></span>
çš„è¡¨è¾¾ï¼Œå³å¯é€šè¿‡é‡‡æ · <span
class="math inline"><em>f</em><sub><em>Y</em></sub></span> å¾—åˆ°æ ·æœ¬
<span
class="math inline"><em>y</em><sub>1</sub>,â€†<em>y</em><sub>2</sub>,â€†â‹¯,â€†<em>y</em><sub><em>M</em></sub></span>
å³å¯ä½œå‡ºä¸‹è¿°ä¼°ç®—ï¼š</p>
<p><span class="math display">$$
\Eop_{x \sim X}[\varphi(x)] = \Eop_{y \sim
Y}\left[\frac{f_X(y)}{f_Y(y)}\varphi(y)\right] \approx
\frac{1}{M}\sum_{k = 1}^M \frac{f_X(y_k)}{f_Y(y_k)}\varphi(y_k)
$$</span></p>
<p>å›åˆ°åŸå…ˆçš„é—®é¢˜ï¼Œæˆ‘ä»¬é¦–å…ˆå¾—åˆ°ï¼š</p>
<p><span class="math display">$$
\frac{\P_\pi(\tau)}{\P_b(\tau)} = \frac{\prod_{(s, a, s') \in \tau}
\pi(a \mid s)\Pe(s' \mid s, a)}{\prod_{(s, a, s') \in \tau} b(a \mid
s)\Pe(s' \mid s, a)} = \prod_{(s, a) \in \tau} \frac{\pi(a \mid s)}{b(a
\mid s)}
$$</span></p>
<p>é‚£ä¹ˆå¯¹äºä»»æ„çš„ <span class="math inline">$s_{\rm param} \in
\mathcal{S}, a_{\rm param} \in \mathcal{A}$</span>ï¼Œæˆ‘ä»¬ä½œä¸‹è¿°è®¡ç®—ï¼š</p>
<p><span class="math display">$$
\begin{aligned}
Q^\pi(s_{\rm param}, a_{\rm param}) &amp;= \Eop_{\tau \sim \pi}[G(\tau)
\mid s_0 = s_{\rm param}, a_0 = a_{\rm param}] \\
&amp;= \Eop_{\tau \sim b}\left[\frac{\P_\pi(\tau)}{\P_b(\tau)}G(\tau)
\middle| s_0 = s_{\rm param}, a_0 = a_{\rm param}\right] \\
&amp;= \Eop_{\tau \sim b}\left[G(\tau)\prod_{(s, a) \in \tau}
\frac{\pi(a \mid s)}{b(a \mid s)} \middle| s_0 = s_{\rm param}, a_0 =
a_{\rm param}\right] \\
\end{aligned}
$$</span></p>
<p>é‚£ä¹ˆï¼Œè‹¥åœ¨åˆ©ç”¨è¡Œä¸ºç­–ç•¥ <span class="math inline"><em>b</em></span>
é‡‡æ ·å¾—åˆ°çš„è½¨è¿¹ <span class="math inline"><em>Ï„</em></span> ä¸­ï¼Œæ—¶åˆ»
<span class="math inline"><em>t</em></span> æ™ºèƒ½ä½“ä½äºçŠ¶æ€ <span
class="math inline"><em>s</em><sub><em>t</em></sub></span>ï¼Œåšå‡ºå†³ç­–
<span class="math inline"><em>a</em><sub><em>t</em></sub></span>
è½¬ç§»åˆ°çŠ¶æ€ <span
class="math inline"><em>s</em><sub><em>t</em>â€…+â€…1</sub></span>
å¹¶è·å¾—æ”¶ç›Š <span
class="math inline"><em>r</em><sub><em>t</em>â€…+â€…1</sub></span>ï¼Œå¯ä»¥å¾—åˆ°å…¶ç­–ç•¥è¯„ä¼°é˜¶æ®µæ‰€é‡‡ç”¨çš„æ›´æ–°ä¸ºï¼š</p>
<p><span class="math display">$$
Q(s_t, a_t) \leftarrow Q(s_t, a_t) + \alpha\left[G_t(\tau)\prod_{k =
t}^{+\infty} \frac{\pi(a_k \mid s_k)}{b(a_k \mid s_k)} - Q(s_t,
a_t)\right]
$$</span></p>
<p>æˆ‘ä»¬ä¹Ÿå¾ˆå®¹æ˜“å‘ç°è‹¥ <span
class="math inline"><em>Ï€</em>â€„=â€„<em>b</em></span>ï¼Œåˆ™å¼‚è½¨è’™ç‰¹å¡æ´›æ§åˆ¶é€€åŒ–ä¸ºåŒè½¨è’™ç‰¹å¡æ´›æ§åˆ¶ã€‚</p>
<h1 id="å‡½æ•°ä¼°è®¡ä¸æ·±åº¦å­¦ä¹ ">å‡½æ•°ä¼°è®¡ä¸æ·±åº¦å­¦ä¹ </h1>
<p>æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ä¸Šè¿°ä»‹ç»çš„æ‰€æœ‰ç®—æ³•ï¼Œå¦‚æœç›´æ¥è¿ç”¨çš„è¯å¯èƒ½é¢ä¸´ä¸€äº›å›°éš¾ï¼Œè¿™æ˜¯å› ä¸ºç°å®é—®é¢˜çš„çŠ¶æ€ç©ºé—´å’Œå†³ç­–ç©ºé—´éƒ½æ˜¯å·¨å¤§çš„ï¼Œæˆ‘ä»¬å¾ˆéš¾å¦‚å®è®°å½•æ¯ä¸€æ¬¡è¿­ä»£æ—¶ä»·å€¼å‡½æ•°åœ¨æ¯ä¸ªçŠ¶æ€ã€æ¯ä¸ªè¡Œä¸ºä¸Šçš„å€¼ï¼Œè¿™ä¼šéœ€è¦å¤§é‡çš„å­˜å‚¨ç©ºé—´ã€‚</p>
<p>è§£å†³è¿™ä¸€é—®é¢˜çš„æœ€å¸¸ç”¨æ–¹æ¡ˆå°±æ˜¯æ„é€ å‡½æ•°ä¼°è®¡ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬éœ€è¦æ‹Ÿåˆä¸€ä¸ªéš¾ä»¥ç›´æ¥è®¡ç®—çš„å‡½æ•°
<span
class="math inline"><em>f</em></span>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ç³»åˆ—è¾ƒå°çš„å‚æ•°
<span class="math inline">$\b w$</span> æ„é€ ä¸€ä¸ªç›¸å¯¹å®¹æ˜“è®¡ç®—çš„å‡½æ•° <span
class="math inline">$f_{\b w}$</span>ï¼Œå°è¯•é€šè¿‡æŸç§æ–¹å¼è°ƒæ•´å‚æ•° <span
class="math inline">$\b w$</span> ä»¥ä»¤ <span class="math inline">$f_{\b
w} \approx f$</span>ã€‚è¿™æ ·å°±å¯ä»¥ä½¿ç”¨ <span class="math inline">$f_{\b
w}$</span> æ¥ä»£æ›¿ <span class="math inline"><em>f</em></span> ä½¿ç”¨ã€‚</p>
<p>å‡½æ•°ä¼°è®¡çš„æ–¹å¼æ˜¯å¤šæ ·çš„ï¼Œå¯è¡Œçš„æ–¹å¼åŒ…æ‹¬çº¿æ€§æ‹Ÿåˆã€å†³ç­–æ ‘ã€æœ€è¿‘é‚»ç­‰ã€‚å½“ç„¶ï¼Œç›®å‰æœ€ä¸ºæ™®éçš„æ–¹å¼æ˜¯ä½¿ç”¨ç¥ç»ç½‘ç»œï¼Œè€Œè°ƒæ•´å‚æ•°çš„æ–¹å¼ä¸€èˆ¬æ˜¯æ¢¯åº¦ä¸‹é™ç®—æ³•ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬ç°åœ¨éœ€è¦ä½¿ç”¨ç¥ç»ç½‘ç»œå­¦ä¹ ç­–ç•¥ <span
class="math inline"><em>Ï€</em></span> çš„çŠ¶æ€ä»·å€¼å‡½æ•° <span
class="math inline"><em>V</em><sup><em>Ï€</em></sup></span>ï¼Œæˆ‘ä»¬ä½¿ç”¨å‚æ•°
<span class="math inline">$\b w$</span> æ„å»ºä¸€ä¸ªå‡½æ•° <span
class="math inline">$V_{\b w}$</span>ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ MSE
æ¥æ„å»ºä¸€ä¸ªç®€å•çš„è¡¡é‡æ‹Ÿåˆæ•ˆæœçš„æŸå¤±å‡½æ•°ï¼š</p>
<p><span class="math display">$$
\mathcal{J}(\b w) := \Eop_{\tau \sim \pi} \left[\frac{1}{|\tau|} \sum_{s
\in \tau} (V^\pi(s) - V_{\b w}(s))^2\right]
$$</span></p>
<p>ä¹‹åæˆ‘ä»¬è®¡ç®—å…¶æ¢¯åº¦ï¼š</p>
<p><span class="math display">$$
\begin{aligned}
\nabla_{\b w}\mathcal{J}(\b w) &amp;= \nabla_{\b w}\Eop_{\tau \sim \pi}
\left[\frac{1}{|\tau|} \sum_{s \in \tau} (V^\pi(s) - V_{\b
w}(s))^2\right] \\
&amp;= \Eop_{\tau \sim \pi} \left[\frac{1}{|\tau|} \sum_{s \in \tau}
\nabla_{\b w}(V^\pi(s) - V_{\b w}(s))^2\right] \\
&amp;= -2\Eop_{\tau \sim \pi} \left[\frac{1}{|\tau|} \sum_{s \in \tau}
(V^\pi(s) - V_{\b w}(s))\nabla_{\b w}V_{\b w}(s)\right]
\end{aligned}
$$</span></p>
<p>è®¾å®šå­¦ä¹ ç‡ä¸º <span
class="math inline">â€…âˆ’â€…1/2â€…â‹…â€…<em>Î±</em></span>ï¼Œå³å¯å¾—åˆ°å‚æ•° <span
class="math inline">$\b w$</span> çš„æ›´æ–°æ–¹å¼ï¼š</p>
<p><span class="math display">$$
\b w \leftarrow \b w - \frac{1}{2}\alpha\nabla_{\b w}\mathcal{J}(\b w) =
\b w + \alpha\Eop_{\tau \sim \pi} \left[\frac{1}{|\tau|} \sum_{s \in
\tau} ({\color{red} V^\pi(s)} - V_{\b w}(s))\nabla_{\b w}V_{\b
w}(s)\right]
$$</span></p>
<p>è¿™é‡Œæ³¨æ„ä¸Šè¿°ç­–ç•¥ä¸­æ ‡çº¢é¡¹ï¼Œæ˜¾ç„¶è¿™é‡Œæˆ‘ä»¬éœ€è¦å¾—åˆ°çœŸå®å€¼ï¼Œæˆ–è€…å¯é çš„çœŸå®å€¼ä¼°è®¡æ‰èƒ½æ›´æ–°å‚æ•°ã€‚è€Œç”±äºå¼ºåŒ–å­¦ä¹ éç›‘ç£å­¦ä¹ ï¼Œè¿™é‡Œä¸å­˜åœ¨æ ‡ç­¾ï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡é‡‡æ ·æˆ–è€…ä¼°è®¡çš„æ–¹å¼å¤„ç†è¿™ä¸€é¡¹ã€‚</p>
<p>å¦‚æœé‡‡ç”¨ MC æ–¹æ³•ï¼Œè¿™ä¸€é¡¹å°±å¯ä»¥ä½¿ç”¨è½¨è¿¹ç´¯è®¡æ”¶ç›Šï¼š</p>
<p><span class="math display">$$
\b w \leftarrow \b w + \alpha\Eop_{\tau \sim \pi} \left[\frac{1}{|\tau|}
\sum_{s \in \tau} ({\color{red} G_t(\tau)} - V_{\b w}(s))\nabla_{\b
w}V_{\b w}(s)\right]
$$</span></p>
<p>å¦‚æœé‡‡ç”¨ TD æ–¹æ³•ï¼Œè¿™ä¸€é¡¹å°±å¯ä»¥ä½¿ç”¨ bootstrap çš„ TD targetï¼š</p>
<p><span class="math display">$$
\b w \leftarrow \b w + \alpha\Eop_{\tau \sim \pi} \left[\frac{1}{|\tau|}
\sum_{(s, r, s') \in \tau} ({\color{red} r + \gamma V_{\b w}(s')} -
V_{\b w}(s))\nabla_{\b w}V_{\b w}(s)\right]
$$</span></p>
<p>å½“ç„¶å¦‚æœä½¿ç”¨ TD(<span
class="math inline"><em>Î»</em></span>)ï¼Œè¿™ä¸€é¡¹å°±æ˜¯ç›¸åº”çš„ TD targetã€‚</p>
<p>ç›®å‰åŸºäºé€šè¿‡ç¥ç»ç½‘ç»œå®ç°çš„å‡½æ•°ä¼°è®¡ï¼Œæˆ‘ä»¬å¯ä»¥å°† Q learning
è½¬æ¢ä¸ºæ·±åº¦å­¦ä¹ ç®—æ³• DQNã€‚</p>
<h2 id="deep-q-network-dqn">Deep Q Network (DQN)</h2>
<p>ä½¿ç”¨ç¥ç»ç½‘ç»œåï¼ŒQ learning
çš„åŸºæœ¬ç®—æ³•æ¡†æ¶ä¸å˜ï¼Œä¾ç„¶ä¸ä¸Šä¸€èŠ‚ä¸­æ‰€ç¤ºä¸€è‡´ï¼Œä»…éœ€è¦å°†ä»·å€¼å‡½æ•° <span
class="math inline"><em>Q</em><sup><em>Ï€</em></sup></span>
æ›¿æ¢ä¸ºä¸€ä¸ªç¥ç»ç½‘ç»œ <span class="math inline">$f_{\b w}: \mathcal{S} \to
\mathbb{R}^{|\mathcal{A}|}$</span>ã€‚è¯¥ç¥ç»ç½‘ç»œç»“æ„çš„è¯­ä¹‰ä¸ºï¼Œå…¶æ¥å—å½“å‰çš„çŠ¶æ€
<span
class="math inline"><em>s</em>â€„âˆˆâ€„ğ’®</span>ï¼Œè¾“å‡ºè¿™ä¸ªçŠ¶æ€ä¸‹æ‰€æœ‰å¯èƒ½çš„è¡Œä¸ºå¸¦æ¥çš„ä»·å€¼å‡½æ•°ä¼°è®¡ï¼Œå³
<span class="math inline">$f_{\b w}(s) = [Q_{\b w}(s, a_1), Q_{\b w}(s,
a_2), \cdots, Q_{\b w}(s, a_{|\mathcal{A}|})]$</span>ã€‚</p>
<p>æ­¤å¤–ï¼ŒåŸºäºä¸Šè¿°ç¥ç»ç½‘ç»œè®¾è®¡ï¼Œç­–ç•¥æ”¹è¿›è¿‡ç¨‹ä¸­åˆ©ç”¨ä»·å€¼å‡½æ•°ç”Ÿæˆè¡Œä¸ºç­–ç•¥çš„æ–¹å¼åœ¨ä»£ç ä¸Šæ˜¯æ˜¾ç„¶çš„ï¼Œåªéœ€è¦å°†ç¥ç»ç½‘ç»œè¾“å‡ºçš„æ•°ç»„æ±‚æœ€å¤§å€¼åç›´æ¥åº”ç”¨
<span class="math inline"><em>Îµ</em></span>
è´ªå¿ƒæ–¹å¼å³å¯ï¼Œæ‰€ä»¥ä¸éœ€è¦å¦å¼€è¾Ÿå†…å­˜å­˜å‚¨ç­–ç•¥æœ¬èº«ã€‚</p>
<p>è€Œç­–ç•¥è¯„ä¼°è¿‡ç¨‹åˆ™ä¸ºä¸Šä¸€éƒ¨åˆ†æ‰€ä»‹ç»çš„æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼š</p>
<p><span class="math display">$$
\b w \leftarrow \b w + \alpha\Eop_{\tau \sim \pi} \left[\frac{1}{|\tau|}
\sum_{(s, a) \in \tau} ({\color{red} Q^\pi(s, a)} - Q_{\b w}(s,
a))\nabla_{\b w}Q_{\b w}(s, a)\right]
$$</span></p>
<p>æ•…åŸºæœ¬çš„ DQN ç®—æ³•æµç¨‹ä¸ºï¼š</p>
<ul>
<li>åˆå§‹åŒ–ä¼°è®¡ä»·å€¼å‡½æ•°çš„ç¥ç»ç½‘ç»œ <span class="math inline">$f_{\b
w}$</span></li>
<li>å¾ªç¯æ‰§è¡Œä¸‹è¿°æ­¥éª¤ç›´åˆ°æ”¶æ•›
<ul>
<li>ã€ç­–ç•¥æ”¹è¿›ã€‘æ±‚å– <span class="math inline">$a_{\rm max} = \argmax
f_{\b w}(s)$</span> å¹¶åˆ©ç”¨ <span class="math inline"><em>Îµ</em></span>
è´ªå¿ƒæ–¹å¼ç”Ÿæˆè¡Œä¸ºç­–ç•¥å†³ç­–æ‰§è¡Œ</li>
<li>ã€ç­–ç•¥è¯„ä¼°ã€‘åˆ©ç”¨æ¢¯åº¦æ›´æ–°ç¥ç»ç½‘ç»œå‚æ•°</li>
</ul></li>
</ul>
<p>è‡³äºå¦‚ä½•æ±‚è§£æ¢¯åº¦ï¼Œæˆ‘ä»¬</p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/02/20/2023-spring-record/" rel="prev" title="2023 æ˜¥å­£å­¦æœŸè®°å½•">
                  <i class="fa fa-chevron-left"></i> 2023 æ˜¥å­£å­¦æœŸè®°å½•
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/05/26/ancient-ja/" rel="next" title="å¤æ—¥è¯­è¯­æ³•ç¬”è®°">
                  å¤æ—¥è¯­è¯­æ³•ç¬”è®° <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments"><div id="twikoo-comments"></div></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2021 â€“ 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ashitemaru</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  
  <script src="https://unpkg.com/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/third-party/search/local-search.js"></script>


  <script class="next-config" data-name="mermaid" type="application/json">{&quot;enable&quot;:true,&quot;theme&quot;:&quot;default&quot;,&quot;js&quot;:{&quot;url&quot;:&quot;https:&#x2F;&#x2F;unpkg.com&#x2F;mermaid@8.9.3&#x2F;dist&#x2F;mermaid.min.js&quot;,&quot;integrity&quot;:&quot;sha256-OyJHvRcZHaRR6Ig73ppxF4QXk8HzvfgTprRWkulCkfY&#x3D;&quot;}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{&quot;enable&quot;:true,&quot;tags&quot;:&quot;none&quot;,&quot;js&quot;:{&quot;url&quot;:&quot;https:&#x2F;&#x2F;unpkg.com&#x2F;mathjax@3.1.4&#x2F;es5&#x2F;tex-mml-chtml.js&quot;,&quot;integrity&quot;:&quot;sha256-ncNI9OXOS5Ek4tzVYiOMmN&#x2F;KKCPZ6V0Cpv2P&#x2F;zHntiA&#x3D;&quot;}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="twikoo" type="application/json">{&quot;enable&quot;:true,&quot;visitor&quot;:true,&quot;envId&quot;:&quot;https:&#x2F;&#x2F;vercel-deploy-two.vercel.app&quot;,&quot;el&quot;:&quot;#twikoo-comments&quot;}</script>
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.twikoo.el)
    .then(() => NexT.utils.getScript(
      CONFIG.twikoo.jsUrl || 'https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js',
      { condition: window.twikoo }
    ))
    .then(() => {
      twikoo.init(CONFIG.twikoo);
    });
});
</script>
<style>
.post-block, .comments {
  overflow: visible;
}
.tk-owo-emotion {
  display: inline-block;
}
</style>

</body>
</html>
