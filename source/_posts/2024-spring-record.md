---
title: 2024 春季学期记录
date: 2024-02-26 13:07:01
category:
    - 【生活记录】日记
mathjax: true
---

虽然有预感这一学期可能和之前一样每天都是无聊的重复，但是还是开个日记，以免真的有什么想要记录的时候却苦恼于没有地方写。

<!-- more -->

# 2024.02.26

这一学期的第一天，然而今天就要处理掉不少工作：

- THUInfo 一些信息需要提交掉
- 软工那边需要拉一些人
- TON 实验的打表还没做

虽然都是一些很零碎的小工作，可能一个下午也就做完了，但不知道为什么最近我的拖延症越来越明显，以往是有那么点拖延但也不至于现在这样。

---

忙活了一整天，软工那边似乎暂且不需要我参与什么，THUInfo 那边迅哥哥也暂且不急，所以今天就几乎全用来跑 TON 的实验，然后因为接到了第二天有腾讯 HR 面试的通知，还稍微做了点准备。

TON 这边实验的想法很简单，因为学长想要收集一些真实网络拥塞控制的情况来做 RL 训练，然而 RL 训练时现跑网络发包会导致训练大幅度延迟，所以不得不去思考怎么缩时间。那么，有个想法就是打表，针对所有可能的参数把 baseline CC 的 performance 都打表打出来，训练的时候直接读取就行。

然而参数空间不得不说还是挺大的，所以可能需要多机打表，目前讨论确定使用 50 台机子打表，那么就需要一个中心机来 assign task，而这就是我需要做的。

最初我觉得直接在 SSH 后面附上命令就可以了，然而如果直接使用 `os.system("ssh [name]@[ip] '[cmd]')` 的方式，就和串行没有什么区别了，而且这一方法需要保持 SSH 连接，以我现在的知识来说，我还真不知道如何让中心机和其他 50 台机子同时保持 SSH 连接。

所以最终采用的方式是让中心机发指令给边缘机，令其开一个 tmux 后台运行，之后就可以直接断开 SSH 了。

不过说起来简单，操作的时候事情还不少。首先边缘机上没装 tmux，需要手动装，然而要装就需要 sudo，sudo 又需要手动输密码，怎么在代码里面模拟终端交互行为当时卡了有段时间。不过最后还是找到了 paramiko 这个库，其 `invoke_shell` 方法可以模拟终端，大概类似于：

{% codeblock lang:python Python %}
# Connect to remote server
client = paramiko.SSHClient()
client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
client.connect(ip, username="[name]", password="[password]", port=22)

# Run script
channel = client.invoke_shell()
channel.send("cd ~/pantheon && tmux new-session -d -s ton '[command]'\n")
output = channel.recv(65535).decode("utf-8")
{% endcodeblock %}

整体用起来还是比较舒服的。

然而就在我以为一切都已经解决了的时候，我发现 loss rate 一直为零，这意味着我有参数没有设置正确。这个时候，我得知了一个令我震惊的东西：**Python2 的除法对整数是向下取整的**。写惯了 Python3 里面默认返回浮点数的除法，这个 bug 我完全没有注意到，找了大概有一整个晚上才发现。

不过就算这样还是有无法理解的地方，那就是现在依然存在有的时候程序随机爆炸，打表打到一半突然死亡，这个更是我不知道原因到底在哪里，明天和贾老师联系一下再来思考。

# 2024.02.27

今天是约定了的腾讯那边 HR 面试的日子，本来以为这个面试应该多正式，结果就是线上和 HR 聊了一些我也不知道有关还是无关的问题也就结束了，晚上上传了一下身份信息之后似乎就只要等 offer 就可以了。

昨天出勤的时候无意中把鸢尾花打到了 100.45，今天自然就没有忍住出勤去了，手感确实不算差，大概三把左右就把鸢尾花鸟加拿下。

晚上回来主要是因为要给 fyk 他们简单讲一节日语课，九点钟讲到十二点左右，本来想着赶快开始把贾老师和腾讯那边工作启动的，还是因为太累了，就先睡了。

目前看来生活还是比较 under control 的，希望这种势头能够保持下去吧。

# 2024.02.28

下午有导师的课程，但是十一点就已经从床上爬起来了。爬起来之后简单折腾了一下腾讯那边的工作，把 code base 基本修好了之后就算是启动工作了，忙完这些清理了一下宿舍垃圾就去上课了。

课程本身是没啥意思的，不过有意思的事情是明明这是计算机系的专业课程，却莫名其妙吸引了不少来自美院、教育学院的文科同学来上课，我对这一现象暂且找不到合理的解释。

上完课就去工位坐牢，腾讯那边的工作启动起来了之后目前来看还都是比较顺畅的，新的 baseline algorithm 已经跑起来了，确实比之前有相当大的提升。现在的核心任务就是统计 1% low FPS 这个指标，然后针对这个指标做一些简单的文献调研。除此以外，大概就是得花时间手搓一下 QoE，看一眼离线最优算法能够搞出来什么东西，远期的话 code base 应该需要对窗口延迟等指标做一些调整，但是这些已经是后话了。

另外就是 TON 实验现在完全没有动，感觉还是得找个时间去工位好好坐牢一下。

# 2024.02.29

今天主要就用来出勤了，不过出勤也是收获颇丰，把风神和白香水都鸟加了，于是顺利取得 14.5 全鸟加的成绩。大概，3 月更新之后把那几首歌打完，b15 侧地板也就差不多来到 14.3，这样的话就可以简单做个分表了。后续一方面吃下位 14+ 的分，一方面打算打 14.3 的全鸟加。

工作上的话，THUInfo 那边因为拖延惹得迅哥哥有点生气，所以赶快把信息交掉了。腾讯那边 1% low FPS 的数字有点奇异难看，可能还是得对着 log 再去想想有没有什么地方出现问题，因为最多延迟两帧，再怎么说也不太可能出现那么大的帧持续时间，除非就是送显时间戳本身距离就很离谱。TON 那边还在尝试 debug，也不知道什么时候能够搞出来，暂且先搞着吧。

# 2024.03.01

今天早上看了一眼服务器，大概挂掉了 5 台，感觉还是可以控制的。然而我现在最懊悔的事情是我居然在程序里面没有存储中间结果，这导致我要是挂程序了就必须从头开始。现在决定就是，递进式地更换程序，哪台服务器挂了我就把哪台的换成能保存中间结果的，没挂的就最好。然后我还得写一个监控程序观察哪台服务器挂了，这就得去找找阿里云相关的 API 了。

下午混掉组会，简单思考了一下那个脚本的写法，发觉需要研究阿里云 API，然而一顿折腾我发现阿里云的 API 实在是难以使用，所以只能搁置。晚上吃了顿饭心灰意冷决定摸鱼，打了一晚上麻将和舍友刚教我的湖南跑胡子，然后顺利发现服务器欠费停机，所有的实验结果全都没保存下来。

至此，我只能说，我又一次被这玩意打败了，反正已经这样了，不如赶快睡觉保命。

# 2024.03.02

今天的任务只有一个，就是出勤，迅速解决掉本次更新里面的两个 14，电光石火以及华为。然而今天实在是有点诸事不顺，早上堵门来到上地的时候人数就已经逼近 10 人，蹭了一下非律的华为迅速解决掉之后，来了个来上地团建的小团体，人数直接突破 20，这完全没法打了，而且这个时候我电光石火甚至还没鸟，手感爆炸烂。退勤之后越想越气，于是立刻转战天通苑机厅，结果人也完全说不上少。然而还好在场的人还都比较友善地让我反复刷电光石火，最终终于在快闭店的时候，鏖战 30 把拿下电光石火。

晚上回去的时候精神状态实际上就已经很不好了，主要是太疲劳，前一天晚上没睡多长时间今天又奋战了一整天，于是只能赶快计划着回去睡大头觉。

# 2024.03.03

睡得很晚才起，大概到了晚上四五点钟才从床上下来，今天得立刻前往工位开始赶事情。周一约了 mfy 把软工课上的事情准备好，那今天已经得尽力拿下手上的工作。

现在 TON 的实验暂且写了一个每隔 15 分钟监控一下并且看情况重启的版本，现在也不是很清楚是不是能用的下去，至少目前为止所有事情都暂且按着我想的方式发展，希望最终没事。以及虽然这个实验的经费最终是要走报销渠道，但是毕竟现在暂且是从我手上出钱，或多或少还是有点心疼的。过了一段时间，我观察了一下那个脚本的运作情况，果然有一次检查到了死机子，并且很成功地重启了这台机子，也就是说目前为止理论上应该能支撑到这个实验跑完了。

# 2024.03.04

今天主要还是折腾了一下 TON 实验的事情，因为我发现过了一晚上运行进度只有 5%，按这个估算，需要十天才能跑完，这完全不能容忍。和贾老师一波讨论之后决定降低参数采样率，减小遍历空间来控制实验时间，这样操作之后目前预计明天就能拿到第一波试验结果。

晚上和 mfy 讨论了一下软工的课前准备，目前也已经有了基本的 timeline，希望一切正常推进吧。

然而最让人烦心的事情就是，大四的那个实习写的小程序，因为里面有些静态图片我挂在了腾讯云上，而这个存储桶似乎因为欠费已经释放掉了，导致现在小程序已经几乎没法使用。但是，我对这个实习实在是有点厌恶，真的很毁坏我现在 under control 的心情。