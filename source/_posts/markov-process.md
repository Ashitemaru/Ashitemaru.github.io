---
title: 马尔可夫随机过程杂谈
date: 2023-11-13 02:25:08
mathjax: true
category:
    - 【杂谈】数学
---

最近学网络建模，发现随机过程真的应用太广了，尤其是马尔可夫过程，在之前的 RL 笔记里面也有提到但是没写很多，这次想着还是稍微做点总结比较好。

<!-- more -->

# 随机过程与马尔可夫性质

所谓随机过程实际上就是一个随机变量的序列 $\{X_t\}, t \in T$，$t$ 一般都解释为时间，体现随机过程随时间的推移。如果 $T$ 是一个可数集（一般都是自然数集 $\mathbb{N}$），那么这就是**离散时间随机过程**。如果 $T$ 是 $\mathbb{R}$ 上的一段区间，那么这就是**连续时间随机过程**。随机变量 $X_t$ 的所有可能取值构成的集合称为**状态空间**。

考虑一个状态空间 $\mathcal{S}$ 至多可数的离散时间随机过程 $\{X_t\}_{t \in \mathbb{N}}$。该随机过程的**马尔可夫性质**是指，对于任意 $t \in \mathbb{N}$，如果已知 $X_t$ 的取值，那么 $X_{t + 1}$ 的取值与 $X_0, X_1, \cdots, X_{t - 1}$ 的取值都是独立的。这个性质可以用下面的式子来表示：

$$
\mathbb{P}(X_{t + 1} = j \mid X_t = i, X_{t - 1} = i_{t - 1}, \cdots, X_0 = i_0) = \mathbb{P}(X_{t + 1} = j \mid X_t = i)
$$

这里 $i, j, i_0, \cdots, i_{t - 1} \in \mathcal{S}$ 均为任意的状态。

鉴于此，一个马尔可夫随机过程可以定义一个**转移概率矩阵** $P = (p_{ij})_{n \times n}$，这里 $n$ 为状态空间 $\mathcal{S}$ 的大小，其各元素定义为 $p_{ij} := \mathbb{P}(X_{t + 1} = j \mid X_t = i)$。

这个矩阵的重要性质是，每一行的和为 $1$：

$$
\sum_{k = 1}^n p_{ik} = \sum_{k = 1}^n \mathbb{P}(X_{t + 1} = k \mid X_t = i) = 1
$$

{% note info no-icon %}
一个满足马尔可夫性质的状态空间可数离散时间随机过程一般称为**马尔可夫链**。

任何马尔可夫链均可以按照上述过程定义转移概率矩阵。然而在一些特别的实际问题中，转移概率矩阵可能是与时间相关的，而我们上述的讨论中矩阵并不随时间推移而改变，这类马尔可夫链称为**时间齐次马尔可夫链**，也是强化学习问题中最常见的建模。

时间不齐次的马尔可夫链则会在后面提及连续时间马尔可夫链时讨论。
{% endnote %}

如果考虑多步转移，我们可以通过概率运算发现：

$$
\begin{aligned}
\mathbb{P}(X_{t + r + 1} = j \mid X_t = i) &= \sum_{k = 1}^n \mathbb{P}(X_{t + r + 1} = j \mid X_{t + 1} = k) \mathbb{P}(X_{t + 1} = k \mid X_t = i) \\
&= \sum_{k = 1}^n \mathbb{P}(X_{t + r} = j \mid X_t = k) \mathbb{P}(X_{t + 1} = k \mid X_t = i)
\end{aligned}
$$

这里最后一个等号利用了时间齐次的特性。利用上述式子，我们可以发现马尔可夫链的多步状态转移可以通过矩阵的幂次表现。具体而言，记 $P^r$ 的第 $(i, j)$ 位置上的元素为 $p^{(r)}_{ij}$，则：

$$
p^{(r)}_{ij} = \mathbb{P}(X_{t + r} = j \mid X_t = i)
$$

# 马尔可夫链的可达性与可约性

首先我们来定义**可达性**。如果对于任意的 $i, j \in \mathcal{S}$，存在 $r \in \mathbb{N}$ 使得 $p^{(r)}_{ij} = \mathbb{P}(X_{t + r} = j \mid X_t = i) > 0$，那么称 $j$ 是从 $i$ 可达的，记作 $i \to j$。如果 $i \to j$ 且 $j \to i$，那么称 $i$ 和 $j$ 是**互达**的，记作 $i \leftrightarrow j$。

可达性的直观理解是简单的。$i \to j$ 的含义即为，从状态 $i$ 出发，经过有限步转移，可以到达状态 $j$。

不难验证互达的自反性、对称性和传递性，从而互达构成状态空间上的等价关系，这意味着可以据此划分等价类。从而，若一个马尔可夫链的状态空间在互达关系上仅有一个等价类，则该马尔可夫链**不可约**。

不可约性的直观理解也是简单的。不可约的马尔可夫链的所有状态之间都能通过有限步的状态转移两两互达。
